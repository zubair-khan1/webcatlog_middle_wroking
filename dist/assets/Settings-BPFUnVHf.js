import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as r,ae as j,at as g,ad as N,aN as k,aM as w}from"./vendor-icons-BBHJ0ezg.js";import{s as x}from"./index-76QHltB_.js";import"./vendor-react-Ojr5pEEK.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const E=()=>{const[o,c]=r.useState([{key:"commission_rate",value:.15,label:"Commission Rate",description:"Platform commission on each sale",type:"percent",icon:e.jsx(j,{size:18})},{key:"payout_delay_days",value:3,label:"Payout Delay",description:"Days before seller receives payout",type:"days",icon:e.jsx(g,{size:18})},{key:"max_downloads_per_order",value:10,label:"Max Downloads",description:"Download limit per order",type:"number",icon:e.jsx(N,{size:18})}]),[u,y]=r.useState(!0),[d,m]=r.useState(!1),[f,i]=r.useState(!1);r.useEffect(()=>{(async()=>{try{const{data:t,error:n}=await x.from("platform_config").select("*");if(n)throw n;t&&c(s=>s.map(l=>{const p=t.find(v=>v.key===l.key);return p?{...l,value:p.value}:l}))}catch(t){console.error("Failed to fetch configs:",t)}finally{y(!1)}})()},[]);const h=(a,t)=>{i(!1),c(n=>n.map(s=>s.key===a?{...s,value:s.type==="percent"?parseFloat(t)/100:parseInt(t)}:s))},b=async()=>{m(!0);try{for(const a of o){const{error:t}=await x.from("platform_config").upsert({key:a.key,value:a.value,updated_at:new Date().toISOString()},{onConflict:"key"});if(t)throw t}i(!0),setTimeout(()=>i(!1),3e3)}catch(a){console.error("Failed to save configs:",a),alert("Failed to save settings")}finally{m(!1)}};return u?e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-accent-primary border-t-transparent rounded-full"})}):e.jsxs("div",{className:"space-y-8 animate-fade-in pb-12",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-textMain mb-2",children:"Platform Settings"}),e.jsx("p",{className:"text-textMuted",children:"Configure marketplace commission and policies"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-accent-secondary/10 border border-accent-secondary/20 flex items-start gap-3",children:[e.jsx(k,{size:20,className:"text-accent-secondary-fg mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-textMain",children:"Changes affect new orders only"}),e.jsx("p",{className:"text-sm text-textMuted",children:"Existing orders will retain their original commission rate and settings."})]})]}),e.jsx("div",{className:"space-y-4",children:o.map(a=>e.jsx("div",{className:"p-6 bg-surface border border-border rounded-2xl",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-accent-primary/10 text-accent-primary",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"font-bold text-textMain block mb-1",children:a.label}),e.jsx("p",{className:"text-sm text-textMuted mb-4",children:a.description}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",value:a.type==="percent"?Math.round(Number(a.value)*100):a.value,onChange:t=>h(a.key,t.target.value),min:(a.type==="percent",1),max:a.type==="percent"?50:100,className:"w-24 px-4 py-2 bg-surfaceHighlight border border-border rounded-xl text-textMain text-center font-medium focus:outline-none focus:border-accent-primary"}),e.jsxs("span",{className:"text-textMuted",children:[a.type==="percent"&&"%",a.type==="days"&&"days",a.type==="number"&&"downloads"]})]})]})]})},a.key))}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:b,disabled:d,className:"flex items-center gap-2 px-6 py-3 bg-accent-primary text-accent-primary-fg font-bold rounded-xl hover:brightness-110 transition-all disabled:opacity-50",children:[e.jsx(w,{size:18}),d?"Saving...":"Save Changes"]}),f&&e.jsx("span",{className:"text-accent-primary font-medium animate-fade-in",children:"âœ“ Changes saved successfully"})]})]})};export{E as default};
