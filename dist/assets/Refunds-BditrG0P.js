import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as x,L as U,ao as z,aH as F,X as L,aN as q,u as E}from"./vendor-icons-BBHJ0ezg.js";import{e as I,f as $}from"./useRefundsAndWithdrawals-DUJgh36L.js";import"./index-76QHltB_.js";import"./vendor-react-Ojr5pEEK.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const G=()=>{var p,b,h,g,f,j,N,v;const[a,R]=x.useState("reported"),[s,n]=x.useState(null),[u,i]=x.useState(""),{requests:c,isLoading:_,error:o,refetch:C}=I(a),{updateStatus:A,isLoading:d}=$(),H=t=>{switch(t){case"reported":return"bg-amber-500/10 text-amber-400 border-amber-500/20";case"under_review":return"bg-purple-500/10 text-purple-400 border-purple-500/20";case"approved":return"bg-blue-500/10 text-blue-400 border-blue-500/20";case"rejected":return"bg-red-500/10 text-red-400 border-red-500/20";case"completed":return"bg-green-500/10 text-green-400 border-green-500/20";default:return"bg-surfaceHighlight text-textMuted border-border"}},m=t=>{switch(t){case"not_as_described":return"Not as Described";case"technical_issues":return"Technical Issues";case"missing_files":return"Missing Files";case"quality_issues":return"Quality Issues";default:return"Other"}},l=async t=>{if(!s)return;(await A(s.id,t,u)).success&&(n(null),i(""),C())},S=t=>a===t?"bg-accent-tertiary text-textInverse shadow-lg":"bg-surface text-textMuted hover:text-textMain hover:bg-surfaceHighlight border border-border";return _?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(U,{className:"animate-spin text-accent-primary",size:32})}):e.jsxs("div",{className:"space-y-8 animate-fade-in pb-12",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-textMain mb-2",children:"Refund Requests"}),e.jsx("p",{className:"text-textMuted",children:"Review and process buyer refund requests"})]})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","reported","under_review","approved","completed","rejected"].map(t=>e.jsx("button",{onClick:()=>R(t),className:`px-4 py-2 rounded-xl text-sm font-medium transition-all ${S(t)}`,children:t.replace("_"," ").replace(/\b\w/g,r=>r.toUpperCase())},t))}),o&&e.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl text-red-400",children:o}),!o&&c.length===0&&e.jsxs("div",{className:"text-center py-20 bg-surface border border-border rounded-2xl",children:[e.jsx(z,{size:48,className:"mx-auto text-textMuted mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-textMain mb-2",children:"No refund requests"}),e.jsx("p",{className:"text-textMuted",children:a==="all"?"No refund requests have been submitted yet.":`No ${a.replace("_"," ")} requests.`})]}),c.length>0&&e.jsx("div",{className:"bg-surface border border-border rounded-2xl overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-surfaceHighlight border-b border-border",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Order"}),e.jsx("th",{className:"text-left p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Buyer"}),e.jsx("th",{className:"text-left p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Reason"}),e.jsx("th",{className:"text-left p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"text-left p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"text-center p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:c.map(t=>{var r,y,w,M,k;return e.jsxs("tr",{className:"hover:bg-surfaceHighlight/50 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-mono text-textMuted",children:((r=t.order)==null?void 0:r.order_number)||"N/A"}),e.jsx("p",{className:"font-medium text-textMain text-sm truncate max-w-[200px]",children:((w=(y=t.order)==null?void 0:y.listing)==null?void 0:w.title)||"Unknown Product"})]})}),e.jsx("td",{className:"p-4",children:e.jsx("p",{className:"text-sm text-textMain",children:((M=t.buyer)==null?void 0:M.full_name)||"Unknown"})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-sm text-textMuted",children:m(t.reason)})}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:"font-bold text-accent-primary",children:["₹",t.refund_amount||((k=t.order)==null?void 0:k.price_amount)||0]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium border ${H(t.status)}`,children:t.status.replace("_"," ")})}),e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsx("button",{onClick:()=>{n(t),i(t.admin_notes||"")},className:"p-2 text-textMuted hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",title:"Review",children:e.jsx(F,{size:16})})})})]},t.id)})})]})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-surface rounded-2xl border border-border max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-slide-up",children:[e.jsx("div",{className:"p-6 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-display font-bold text-textMain",children:"Review Refund Request"}),e.jsx("p",{className:"text-textMuted text-sm mt-1",children:(p=s.order)==null?void 0:p.order_number})]}),e.jsx("button",{onClick:()=>n(null),className:"p-2 hover:bg-surfaceHighlight rounded-lg transition-colors",children:e.jsx(L,{size:20,className:"text-textMuted"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-surfaceHighlight rounded-lg",children:[e.jsx("p",{className:"text-xs text-textMuted uppercase mb-1",children:"Product"}),e.jsx("p",{className:"font-medium text-textMain",children:((h=(b=s.order)==null?void 0:b.listing)==null?void 0:h.title)||"Unknown"})]}),e.jsxs("div",{className:"p-4 bg-surfaceHighlight rounded-lg",children:[e.jsx("p",{className:"text-xs text-textMuted uppercase mb-1",children:"Refund Amount"}),e.jsxs("p",{className:"font-bold text-accent-primary text-lg",children:["₹",s.refund_amount||0]})]}),e.jsxs("div",{className:"p-4 bg-surfaceHighlight rounded-lg",children:[e.jsx("p",{className:"text-xs text-textMuted uppercase mb-1",children:"Buyer"}),e.jsx("p",{className:"font-medium text-textMain",children:((g=s.buyer)==null?void 0:g.full_name)||((j=(f=s.order)==null?void 0:f.buyer)==null?void 0:j.full_name)||"Unknown"})]}),e.jsxs("div",{className:"p-4 bg-surfaceHighlight rounded-lg",children:[e.jsx("p",{className:"text-xs text-textMuted uppercase mb-1",children:"Seller"}),e.jsx("p",{className:"font-medium text-textMain",children:((v=(N=s.order)==null?void 0:N.seller)==null?void 0:v.full_name)||"Unknown"})]})]}),e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(q,{size:18,className:"text-amber-400 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-amber-400 mb-1",children:["Reason: ",m(s.reason)]}),e.jsx("p",{className:"text-sm text-textMain whitespace-pre-wrap",children:s.description})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-textMuted uppercase",children:"Admin Notes"}),e.jsx("textarea",{value:u,onChange:t=>i(t.target.value),placeholder:"Add internal notes about this request...",rows:3,className:"w-full bg-surfaceHighlight border border-border rounded-lg px-4 py-3 text-textMain placeholder:text-textMuted focus:border-accent-primary focus:outline-none resize-none"})]}),s.status!=="refunded"&&e.jsxs("div",{className:"flex flex-wrap gap-3 pt-4 border-t border-border",children:[s.status==="reported"&&e.jsx("button",{onClick:()=>l("under_review"),disabled:d,className:"px-4 py-2 rounded-lg bg-purple-500/10 text-purple-400 border border-purple-500/20 hover:bg-purple-500/20 font-medium text-sm transition-colors disabled:opacity-50",children:"Mark Under Review"}),s.status!=="rejected"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>l("approved"),disabled:d,className:"px-4 py-2 rounded-lg bg-blue-500/10 text-blue-400 border border-blue-500/20 hover:bg-blue-500/20 font-medium text-sm transition-colors disabled:opacity-50",children:"Approve Refund"}),e.jsxs("button",{onClick:()=>l("completed"),disabled:d,className:"px-4 py-2 rounded-lg bg-green-500/10 text-green-400 border border-green-500/20 hover:bg-green-500/20 font-medium text-sm transition-colors disabled:opacity-50",children:[e.jsx(E,{size:14,className:"inline mr-1"}),"Mark Completed"]}),e.jsx("button",{onClick:()=>l("rejected"),disabled:d,className:"px-4 py-2 rounded-lg bg-red-500/10 text-red-400 border border-red-500/20 hover:bg-red-500/20 font-medium text-sm transition-colors disabled:opacity-50",children:"Reject Request"})]})]})]})]})})]})};export{G as default};
