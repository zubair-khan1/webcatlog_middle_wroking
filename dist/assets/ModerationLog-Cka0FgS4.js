import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as i,L as _,G as C,U as y,P as N,H as h,q as L,i as k,aN as v,as as E,h as z,ar as m,av as w,x as c,aH as M,b2 as A,p as S}from"./vendor-icons-BBHJ0ezg.js";import{s as H}from"./index-76QHltB_.js";import"./vendor-react-Ojr5pEEK.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const $=(t,n)=>{const[o,u]=i.useState([]),[d,x]=i.useState(!0),[b,g]=i.useState(null),l=i.useCallback(async()=>{x(!0),g(null);try{let r=H.from("moderation_actions").select(`
                    *,
                    admin:profiles!moderation_actions_admin_id_fkey(id, full_name, email)
                `).order("created_at",{ascending:!1}).limit(100);t&&(r=r.eq("target_type",t));const{data:p,error:s}=await r;if(s)throw s;u(p||[])}catch(r){g(r instanceof Error?r.message:"Failed to fetch moderation history")}finally{x(!1)}},[t,n]);return i.useEffect(()=>{l()},[l]),{actions:o,isLoading:d,error:b,refetch:l}},R=()=>{const[t,n]=i.useState(void 0),{actions:o,isLoading:u,error:d,refetch:x}=$(t),[b,g]=i.useState(null),l=s=>({flag:{icon:e.jsx(S,{size:14}),color:"text-orange-400",bg:"bg-orange-500/10"},unflag:{icon:e.jsx(S,{size:14}),color:"text-green-400",bg:"bg-green-500/10"},restrict:{icon:e.jsx(v,{size:14}),color:"text-yellow-400",bg:"bg-yellow-500/10"},unrestrict:{icon:e.jsx(c,{size:14}),color:"text-green-400",bg:"bg-green-500/10"},suspend:{icon:e.jsx(m,{size:14}),color:"text-red-400",bg:"bg-red-500/10"},unsuspend:{icon:e.jsx(c,{size:14}),color:"text-green-400",bg:"bg-green-500/10"},ban:{icon:e.jsx(A,{size:14}),color:"text-red-500",bg:"bg-red-500/10"},unban:{icon:e.jsx(c,{size:14}),color:"text-green-400",bg:"bg-green-500/10"},approve:{icon:e.jsx(c,{size:14}),color:"text-green-400",bg:"bg-green-500/10"},reject:{icon:e.jsx(m,{size:14}),color:"text-red-400",bg:"bg-red-500/10"},hide:{icon:e.jsx(M,{size:14}),color:"text-yellow-400",bg:"bg-yellow-500/10"},unhide:{icon:e.jsx(M,{size:14}),color:"text-green-400",bg:"bg-green-500/10"},remove:{icon:e.jsx(m,{size:14}),color:"text-red-500",bg:"bg-red-500/10"},restore:{icon:e.jsx(c,{size:14}),color:"text-green-400",bg:"bg-green-500/10"},feature:{icon:e.jsx(w,{size:14}),color:"text-yellow-400",bg:"bg-yellow-500/10"},unfeature:{icon:e.jsx(w,{size:14}),color:"text-gray-400",bg:"bg-gray-500/10"},delete:{icon:e.jsx(m,{size:14}),color:"text-red-400",bg:"bg-red-500/10"},edit:{icon:e.jsx(z,{size:14}),color:"text-blue-400",bg:"bg-blue-500/10"}})[s]||{icon:e.jsx(h,{size:14}),color:"text-gray-400",bg:"bg-gray-500/10"},r=s=>{switch(s){case"user":return e.jsx(y,{size:14});case"listing":return e.jsx(N,{size:14});case"message":return e.jsx(z,{size:14});case"order":return e.jsx(E,{size:14});default:return e.jsx(h,{size:14})}},p=s=>s.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase());return u?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(_,{className:"animate-spin text-blue-500",size:32})}):d?e.jsx("div",{className:"p-6 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsxs("p",{className:"text-red-400",children:["Error: ",d]})}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-white mb-2",children:"Moderation Log"}),e.jsx("p",{className:"text-textMuted",children:"Complete audit trail of all moderation actions"})]}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-surface border border-border rounded-lg text-textSecondary hover:bg-surfaceHighlight transition-colors",children:"Refresh"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-textMuted",children:[e.jsx(C,{size:16}),e.jsx("span",{className:"text-sm",children:"Filter by:"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>n(void 0),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${t===void 0?"bg-accent-primary/20 text-accent-primary":"bg-surface border border-border text-textMuted hover:text-textMain"}`,children:"All"}),e.jsxs("button",{onClick:()=>n("user"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${t==="user"?"bg-blue-500/20 text-blue-400":"bg-surface border border-border text-textMuted hover:text-textMain"}`,children:[e.jsx(y,{size:14})," Users"]}),e.jsxs("button",{onClick:()=>n("listing"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${t==="listing"?"bg-green-500/20 text-green-400":"bg-surface border border-border text-textMuted hover:text-textMain"}`,children:[e.jsx(N,{size:14})," Listings"]})]})]}),e.jsx("div",{className:"bg-surface border border-border rounded-xl overflow-hidden",children:o.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(h,{size:48,className:"mx-auto text-textMuted mb-4 opacity-50"}),e.jsx("p",{className:"text-textMuted",children:"No moderation actions found"})]}):e.jsx("div",{className:"divide-y divide-border",children:o.map(s=>{var f;const a=l(s.action_type),j=b===s.id;return e.jsxs("div",{className:"hover:bg-surfaceHighlight transition-colors",children:[e.jsxs("button",{onClick:()=>g(j?null:s.id),className:"w-full px-6 py-4 flex items-center gap-4 text-left",children:[e.jsx("div",{className:`p-2 rounded-lg ${a.bg}`,children:e.jsx("span",{className:a.color,children:a.icon})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`font-medium ${a.color}`,children:p(s.action_type)}),e.jsx("span",{className:"text-textMuted",children:"on"}),e.jsxs("span",{className:"flex items-center gap-1 text-textSecondary",children:[r(s.target_type),s.target_type]})]}),s.reason&&e.jsx("p",{className:"text-sm text-textMuted truncate",children:s.reason})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(L,{size:14,className:"text-blue-400"}),e.jsx("span",{className:"text-textSecondary",children:((f=s.admin)==null?void 0:f.full_name)||"Admin"})]}),e.jsx("div",{className:"text-sm text-textMuted whitespace-nowrap",children:new Date(s.created_at).toLocaleString()}),e.jsx(k,{size:16,className:`text-textMuted transition-transform ${j?"rotate-180":""}`})]}),j&&e.jsx("div",{className:"px-6 pb-4 pt-0 bg-surfaceHighlight/50",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-textMuted mb-1",children:"Target ID"}),e.jsx("code",{className:"text-xs bg-surface px-2 py-1 rounded text-textSecondary",children:s.target_id})]}),s.notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-textMuted mb-1",children:"Notes"}),e.jsx("p",{className:"text-textMain",children:s.notes})]}),s.previous_state&&e.jsxs("div",{children:[e.jsx("p",{className:"text-textMuted mb-1",children:"Previous State"}),e.jsx("code",{className:"text-xs bg-surface px-2 py-1 rounded text-textSecondary block",children:JSON.stringify(s.previous_state)})]}),s.new_state&&e.jsxs("div",{children:[e.jsx("p",{className:"text-textMuted mb-1",children:"New State"}),e.jsx("code",{className:"text-xs bg-surface px-2 py-1 rounded text-textSecondary block",children:JSON.stringify(s.new_state)})]}),s.reversed_at&&e.jsx("div",{className:"col-span-2",children:e.jsxs("p",{className:"text-yellow-400 flex items-center gap-1",children:[e.jsx(v,{size:14}),"Reversed on ",new Date(s.reversed_at).toLocaleString(),s.reversal_reason&&`: ${s.reversal_reason}`]})})]})})]},s.id)})})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-textMuted",children:[e.jsxs("span",{children:["Showing ",o.length," actions"]}),e.jsxs("span",{children:["Last updated: ",new Date().toLocaleTimeString()]})]})]})};export{R as default};
