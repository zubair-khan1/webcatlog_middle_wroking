import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as c,a2 as z,aJ as L,P as m,A as u,aA as C,aK as R,h as D,L as p,aw as E,ad as A,aH as P}from"./vendor-icons-BBHJ0ezg.js";import{b as V,B as r,s as b}from"./index-76QHltB_.js";import{u as $}from"./useUserRole-CipoVyFC.js";import{u as K}from"./useSavedItems-DwowzrGF.js";import{u as O,L as B}from"./vendor-react-Ojr5pEEK.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const Q=()=>{var N,y;const{user:a}=V(),{hasSellerActivity:g,loading:j}=$(),i=O(),{savedItems:h,isLoading:w}=K(),[d,o]=c.useState("purchased"),[n,M]=c.useState([]),[k,x]=c.useState(!1),[f,H]=c.useState([]),[S,q]=c.useState(!1),[v,_]=c.useState({totalRevenue:"₹0",totalViews:"0",clickRate:"0%",activeListings:"0"});return z.useEffect(()=>{!j&&g&&i("/seller",{replace:!0})},[g,j,i]),c.useEffect(()=>{(async()=>{if(a){x(!0);try{const{data:t,error:l}=await b.from("orders").select(`
            id, order_number, price_amount, status, created_at,
            listing:listings(id, title, image_url, price)
          `).eq("buyer_id",a.id).in("status",["paid","delivered","completed"]).order("created_at",{ascending:!1});if(console.log("[Dashboard] Buyer Orders:",{count:t==null?void 0:t.length,orders:t,error:l,userId:a.id}),l)throw l;M(t||[])}catch(t){console.error("Error fetching purchased orders:",t)}finally{x(!1)}}})()},[a]),c.useEffect(()=>{(async()=>{if(a)try{x(!0);const{count:t}=await b.from("orders").select("*",{count:"exact",head:!0}).eq("buyer_id",a.id).in("status",["paid","delivered","completed"]),{count:l}=await b.from("saved_items").select("*",{count:"exact",head:!0}).eq("user_id",a.id);_({totalRevenue:String(t||0),totalViews:String(l||0),clickRate:"0%",activeListings:"0"})}catch(t){console.error("Error fetching stats:",t)}finally{x(!1)}})()},[a]),e.jsxs("div",{className:"pt-24 px-6 max-w-7xl mx-auto pb-20 animate-fade-in min-h-screen",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-display font-bold text-textMain mb-2",children:"Dashboard"}),e.jsxs("p",{className:"text-textMuted",children:["Welcome back, ",((N=a==null?void 0:a.user_metadata)==null?void 0:N.full_name)||((y=a==null?void 0:a.email)==null?void 0:y.split("@")[0])||"Founder","."]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(r,{variant:"outline",icon:e.jsx(L,{size:16}),onClick:()=>i("/settings"),children:"Settings"}),e.jsx(r,{onClick:()=>i("/submit"),children:"Submit New Kit"})]})]}),e.jsxs("div",{className:"flex border-b border-border mb-8 overflow-x-auto",children:[e.jsx("button",{onClick:()=>o("overview"),className:`px-6 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${d==="overview"?"border-accent-primary text-textMain":"border-transparent text-textMuted hover:text-textMain"}`,children:"Seller Overview"}),e.jsxs("button",{onClick:()=>o("purchased"),className:`px-6 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${d==="purchased"?"border-accent-primary text-textMain":"border-transparent text-textMuted hover:text-textMain"}`,children:["Purchased Kits (",n.length,")"]}),e.jsxs("button",{onClick:()=>o("saved"),className:`px-6 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${d==="saved"?"border-accent-primary text-textMain":"border-transparent text-textMuted hover:text-textMain"}`,children:["Saved / Liked (",h.length,")"]})]}),d==="overview"&&e.jsxs("div",{className:"animate-slide-up",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12",children:[[{label:"Purchased Kits",value:v.totalRevenue,icon:m},{label:"Saved Items",value:v.totalViews,icon:u}].map((s,t)=>e.jsxs("div",{className:"p-6 rounded-xl bg-surface border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-textMuted text-sm",children:s.label}),e.jsx("div",{className:"p-2 rounded-lg bg-surfaceHighlight text-accent-primary",children:e.jsx(s.icon,{size:16})})]}),e.jsx("div",{className:"flex items-end gap-3",children:e.jsx("span",{className:"text-2xl font-bold text-textMain",children:s.value})})]},t)),e.jsxs(B,{to:"/seller",className:"p-6 rounded-xl bg-surface border border-border hover:border-accent-primary transition-all group cursor-pointer block",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-textMuted text-sm",children:"Selling?"}),e.jsx("div",{className:"p-2 rounded-lg bg-surfaceHighlight text-accent-primary group-hover:bg-accent-primary group-hover:text-black transition-colors",children:e.jsx(C,{size:16})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xl font-bold text-textMain",children:"Go to Seller Dashboard"}),e.jsx(R,{className:"text-textMuted group-hover:text-accent-primary transition-colors",size:20})]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 p-6 rounded-xl bg-surface border border-border",children:[e.jsx("h3",{className:"text-lg font-medium text-textMain mb-6",children:"Recent Activity"}),n.length>0?e.jsxs("div",{className:"space-y-4",children:[n.slice(0,3).map(s=>{var t,l;return e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg bg-surfaceHighlight/50 border border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg overflow-hidden bg-surface",children:((t=s.listing)==null?void 0:t.image_url)&&e.jsx("img",{src:s.listing.image_url,alt:s.listing.title,className:"h-full w-full object-cover"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-textMain",children:((l=s.listing)==null?void 0:l.title)||s.order_number}),e.jsx("p",{className:"text-xs text-textMuted",children:new Date(s.created_at).toLocaleDateString()})]})]}),e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-green-500/10 text-green-500 capitalize",children:s.status})]},s.id)}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:()=>o("purchased"),className:"text-sm text-accent-primary hover:text-accent-primary/80 transition-colors",children:"View all purchases →"})})]}):e.jsx("div",{className:"h-[200px] flex items-center justify-center text-center",children:e.jsxs("div",{children:[e.jsx(m,{size:48,className:"mx-auto mb-4 text-textMuted opacity-30"}),e.jsx("p",{className:"text-textMuted",children:"No purchases yet"}),e.jsx("p",{className:"text-xs text-textMuted/60 mt-1",children:"Kits you buy will appear here"})]})})]}),e.jsxs("div",{className:"p-6 rounded-xl bg-surface border border-border",children:[e.jsx("h3",{className:"text-lg font-medium text-textMain mb-6",children:"Recent Messages"}),e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"h-[150px] flex items-center justify-center text-center",children:e.jsxs("div",{children:[e.jsx(D,{size:36,className:"mx-auto mb-3 text-textMuted opacity-30"}),e.jsx("p",{className:"text-textMuted text-sm",children:"No messages yet"}),e.jsx("p",{className:"text-xs text-textMuted/60 mt-1",children:"Messages from sellers will appear here"})]})})})]})]})]}),d==="purchased"&&e.jsx("div",{className:"animate-slide-up",children:k?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(p,{className:"animate-spin text-accent-primary",size:32})}):n.length===0?e.jsxs("div",{className:"p-6 rounded-xl bg-surface border border-border flex flex-col items-center justify-center text-center py-20 col-span-full",children:[e.jsx(m,{size:48,className:"text-textMuted mb-4 opacity-50"}),e.jsx("h3",{className:"text-textMain font-bold text-lg mb-2",children:"No purchased kits yet"}),e.jsx("p",{className:"text-textMuted mb-6 max-w-sm",children:"Start your next project by acquiring a launch-ready foundation."}),e.jsx(r,{onClick:()=>i("/mvp-kits"),children:"Browse Catalog"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(s=>s.listing&&e.jsxs("div",{className:"bg-surface border border-border rounded-xl overflow-hidden group",children:[e.jsxs("div",{className:"relative aspect-video",children:[e.jsx("img",{src:s.listing.image_url||"/placeholder.jpg",className:"w-full h-full object-cover opacity-80",alt:s.listing.title}),e.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 bg-accent-primary/90 rounded-full text-xs font-bold text-black",children:"PURCHASED"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"text-textMain font-bold truncate",children:s.listing.title}),e.jsxs("p",{className:"text-xs text-textMuted mt-1",children:["Order #",s.order_number]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-textMuted text-sm",children:["₹",s.price_amount]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{size:"sm",variant:"outline",icon:e.jsx(E,{size:14}),onClick:()=>i(`/order/${s.id}`),children:"View"}),e.jsx(r,{size:"sm",icon:e.jsx(A,{size:14}),onClick:()=>i(`/order/${s.id}`),children:"Download"})]})]})]})]},s.id))})}),d==="saved"&&e.jsx("div",{className:"animate-slide-up",children:w?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(p,{className:"animate-spin text-accent-primary",size:32})}):h.length===0?e.jsxs("div",{className:"p-6 rounded-xl bg-surface border border-border flex flex-col items-center justify-center text-center py-20",children:[e.jsx(u,{size:48,className:"text-textMuted mb-4 opacity-50"}),e.jsx("h3",{className:"text-textMain font-bold text-lg mb-2",children:"No saved items yet"}),e.jsx("p",{className:"text-textMuted mb-6 max-w-sm",children:"Browse the catalog and save items you're interested in."}),e.jsx(r,{onClick:()=>i("/mvp-kits"),children:"Browse Catalog"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(s=>s.listing&&e.jsxs("div",{className:"bg-surface border border-border rounded-xl overflow-hidden group",children:[e.jsxs("div",{className:"relative aspect-video",children:[e.jsx("img",{src:s.listing.image_url||"",className:"w-full h-full object-cover opacity-80",alt:""}),e.jsx("div",{className:"absolute top-2 right-2 p-2 bg-black/60 rounded-full text-accent-primary cursor-pointer",children:e.jsx(u,{size:16,fill:"currentColor"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"text-textMain font-bold truncate",children:s.listing.title}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("span",{className:"text-textMuted text-sm",children:["₹",s.listing.price]}),e.jsx(r,{size:"sm",variant:"outline",onClick:()=>{var t;return i(`/listing/${(t=s.listing)==null?void 0:t.id}`)},children:"View Kit"})]})]})]},s.id))})}),d==="mylistings"&&e.jsx("div",{className:"animate-slide-up",children:S?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(p,{className:"animate-spin text-accent-primary",size:32})}):f.length===0?e.jsxs("div",{className:"text-center py-20 border border-border border-dashed rounded-2xl",children:[e.jsx(m,{size:48,className:"mx-auto text-textMuted mb-4"}),e.jsx("p",{className:"text-textMuted mb-4",children:"You haven't created any listings yet."}),e.jsx(r,{onClick:()=>i("/submit"),children:"Submit Your First Kit"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(s=>e.jsxs("div",{className:"bg-surface border border-border rounded-xl overflow-hidden hover:border-accent-primary/30 transition-colors",children:[e.jsxs("div",{className:"relative aspect-video",children:[e.jsx("img",{src:s.image_url||"",className:"w-full h-full object-cover",alt:""}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${s.is_live?"bg-accent-primary text-black":"bg-red-500 text-white"}`,children:s.is_live?"LIVE":"DRAFT"})}),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsxs("span",{className:"px-2 py-1 rounded bg-surface/90 text-textMain text-xs font-bold",children:["₹",s.price]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"text-textMain font-bold truncate mb-2",children:s.title}),e.jsx("p",{className:"text-textMuted text-sm line-clamp-2 mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-textMuted mb-4",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(P,{size:12})," ",s.views_count||0," views"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(u,{size:12})," ",s.likes_count||0," likes"]})]}),e.jsx(r,{size:"sm",variant:"outline",className:"w-full",onClick:()=>i(`/details/${s.id}`),children:"View Details"})]})]},s.id))})})]})};export{Q as default};
