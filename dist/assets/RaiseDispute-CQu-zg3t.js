import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as i,x as N,ax as v,aN as p,L as w}from"./vendor-icons-BBHJ0ezg.js";import{u as k}from"./useOrders-B0f_Am1W.js";import{s as x}from"./index-76QHltB_.js";import{e as M,u as S,L as b}from"./vendor-react-Ojr5pEEK.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const D=()=>{const[a,n]=i.useState(!1),[l,d]=i.useState(null);return{createDispute:i.useCallback(async(c,s,m)=>{n(!0),d(null);try{const{data:{user:t}}=await x.auth.getUser();if(!t)throw new Error("Not authenticated");const{error:o}=await x.from("disputes").insert({order_id:c,raised_by:t.id,reason:s,description:m,status:"open"});if(o)throw o;return await x.from("orders").update({status:"disputed"}).eq("id",c),!0}catch(t){return console.error("[useCreateDispute] Error:",t),d(t instanceof Error?t.message:"Failed to create dispute"),!1}finally{n(!1)}},[]),isLoading:a,error:l}},$=()=>{const{id:a}=M(),{order:n,isLoading:l}=k(a),{createDispute:d,isLoading:u,error:c}=D();S();const[s,m]=i.useState(""),[t,o]=i.useState(""),[f,g]=i.useState(!1),j=["Product not as described","Source files missing or incomplete","Technical issues with the kit","Seller not responding","Other issue"],y=async r=>{if(r.preventDefault(),!a||!s)return;await d(a,s,t)&&g(!0)};return l?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-accent-primary border-t-transparent rounded-full"})}):n?f?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-6",children:e.jsxs("div",{className:"max-w-md w-full text-center animate-fade-in",children:[e.jsx("div",{className:"w-16 h-16 bg-accent-primary/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(N,{size:32,className:"text-accent-primary"})}),e.jsx("h2",{className:"text-2xl font-display font-bold text-textMain mb-2",children:"Dispute Submitted"}),e.jsx("p",{className:"text-textMuted mb-6",children:"Our team will review your case and get back to you within 24-48 hours."}),e.jsx(b,{to:`/order/${a}`,className:"inline-block px-6 py-3 bg-accent-primary text-accent-primary-fg font-bold rounded-xl hover:brightness-110 transition-all",children:"Back to Order"})]})}):e.jsx("div",{className:"min-h-screen bg-background py-12 px-6",children:e.jsxs("div",{className:"max-w-lg mx-auto",children:[e.jsxs(b,{to:`/order/${a}`,className:"inline-flex items-center gap-2 text-textMuted hover:text-textMain transition-colors mb-8",children:[e.jsx(v,{size:16}),"Back to Order"]}),e.jsxs("div",{className:"bg-surface border border-border rounded-2xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 rounded-xl bg-red-500/10",children:e.jsx(p,{size:22,className:"text-red-500"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-display font-bold text-textMain",children:"Report an Issue"}),e.jsxs("p",{className:"text-sm text-textMuted",children:["Order #",n.order_number]})]})]}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-textMuted mb-3",children:"What's the issue?"}),e.jsx("div",{className:"space-y-2",children:j.map(r=>e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-colors ${s===r?"bg-accent-primary/10 border-accent-primary/30":"bg-surfaceHighlight border-border hover:border-accent-primary/20"}`,children:[e.jsx("input",{type:"radio",name:"reason",value:r,checked:s===r,onChange:h=>m(h.target.value),className:"sr-only"}),e.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${s===r?"border-accent-primary bg-accent-primary":"border-border"}`,children:s===r&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-white"})}),e.jsx("span",{className:"text-sm text-textMain",children:r})]},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-textMuted mb-2",children:"Additional details"}),e.jsx("textarea",{value:t,onChange:r=>o(r.target.value),rows:4,placeholder:"Please provide more details about your issue...",className:"w-full px-4 py-3 bg-surfaceHighlight border border-border rounded-xl text-textMain placeholder:text-textMuted focus:outline-none focus:border-accent-primary resize-none"})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-accent-secondary/10 border border-accent-secondary/20 text-sm text-textMuted",children:[e.jsx("strong",{className:"text-textMain",children:"Before submitting:"})," Try messaging the seller first. Many issues can be resolved quickly through direct communication."]}),c&&e.jsx("div",{className:"p-3 rounded-lg bg-red-500/10 border border-red-500/20 text-red-500 text-sm",children:c}),e.jsx("button",{type:"submit",disabled:!s||u,className:"w-full flex items-center justify-center gap-2 px-6 py-4 bg-red-500 text-white font-bold rounded-xl hover:bg-red-600 transition-colors disabled:opacity-50",children:u?e.jsxs(e.Fragment,{children:[e.jsx(w,{size:18,className:"animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{size:18}),"Submit Dispute"]})})]})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 mb-4",children:"Order not found"}),e.jsx(b,{to:"/dashboard/orders",className:"text-accent-tertiary hover:underline",children:"View your orders"})]})})};export{$ as default};
