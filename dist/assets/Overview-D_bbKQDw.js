import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as u,n as w,P as y,m as b,x as O,aA as p,as as $,aN as E,h as K,aK as N}from"./vendor-icons-BBHJ0ezg.js";import{s as o}from"./index-76QHltB_.js";import{L as g}from"./vendor-react-Ojr5pEEK.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const U=()=>{const[t,h]=u.useState({totalUsers:0,totalKits:0,pendingSubmissions:0,publishedKits:0,totalOrders:0,totalRevenue:0,totalCommission:0,pendingPayouts:0}),[d,m]=u.useState(!0),[f,l]=u.useState(null);return u.useEffect(()=>{(async()=>{try{m(!0),l(null);const a=async(r,v)=>{try{const{count:n,error:x}=await v;return x?(console.warn(`Failed to fetch count for ${r}:`,x),0):n||0}catch(n){return console.warn(`Exception fetching count for ${r}:`,n),0}},i=async()=>{try{const{data:r,error:v}=await o.from("orders").select("price_amount, commission_amount, status");console.log("[Admin Stats] Orders query result:",{count:r==null?void 0:r.length,error:v,sample:r==null?void 0:r.slice(0,2)});const n=(r==null?void 0:r.filter(c=>["paid","delivered","completed"].includes(c.status)))||[],{count:x}=await o.from("seller_payouts").select("id",{count:"exact",head:!0}).eq("status","scheduled"),L=n.reduce((c,j)=>c+Number(j.price_amount||0),0),P=n.reduce((c,j)=>c+Number(j.commission_amount||0),0);return{totalOrders:n.length,totalRevenue:L,totalCommission:P,pendingPayouts:x||0}}catch(r){return console.warn("Failed to fetch marketplace stats:",r),{totalOrders:0,totalRevenue:0,totalCommission:0,pendingPayouts:0}}},[S,M,k,C,z]=await Promise.all([a("profiles",o.from("profiles").select("id",{count:"exact",head:!0})),a("listings",o.from("listings").select("id",{count:"exact",head:!0})),a("submissions",o.from("submissions").select("id",{count:"exact",head:!0}).eq("status","pending")),a("listings",o.from("listings").select("id",{count:"exact",head:!0}).eq("is_live",!0)),i()]);h({totalUsers:S,totalKits:M,pendingSubmissions:k,publishedKits:C,...z})}catch(a){console.error("Critical error in useAdminStats:",a),l(a instanceof Error?a.message:"Failed to fetch stats")}finally{m(!1)}})()},[]),{stats:t,isLoading:d,error:f}},F=()=>{const{stats:t,isLoading:h,error:d}=U();if(h)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-accent-primary border-t-transparent rounded-full"}),e.jsx("p",{className:"text-textMuted text-sm",children:"Loading statistics..."})]})});if(d)return e.jsxs("div",{className:"p-6 bg-red-500/10 border border-red-500/20 rounded-xl mt-8",children:[e.jsxs("p",{className:"text-red-500 font-medium",children:["Error loading stats: ",d]}),e.jsx("p",{className:"text-textMuted text-sm mt-2",children:"Check the console for more details."})]});if(!t)return e.jsx("div",{className:"p-8 text-textMuted",children:"No stats data available."});const m=[{label:"Total Users",value:(t.totalUsers||0).toLocaleString(),icon:w,color:"sky",trend:"Users",desc:"registered users"},{label:"Total Kits",value:(t.totalKits||0).toLocaleString(),icon:y,color:"leaf",trend:"Active",desc:"available kits"},{label:"Pending",value:(t.pendingSubmissions||0).toLocaleString(),icon:b,color:"buttermilk",trend:(t.pendingSubmissions||0)>0?"Queue":"Clear",desc:"needs review"},{label:"Live",value:(t.publishedKits||0).toLocaleString(),icon:O,color:"leaf",trend:"Published",desc:"active products"}],f=[{label:"Total Orders",value:(t.totalOrders||0).toLocaleString(),icon:y,color:"sky",trend:"Orders",desc:"completed sales"},{label:"Total Revenue",value:`₹${(t.totalRevenue||0).toLocaleString()}`,icon:p,color:"leaf",trend:"GMV",desc:"gross merchandise value"},{label:"Commission Earned",value:`₹${(t.totalCommission||0).toLocaleString()}`,icon:p,color:"leaf",trend:"15%",desc:"platform revenue"},{label:"Pending Payouts",value:(t.pendingPayouts||0).toLocaleString(),icon:b,color:"buttermilk",trend:(t.pendingPayouts||0)>0?"Queue":"Clear",desc:"seller payouts"}],l={leaf:{bg:"bg-accent-primary/10",text:"text-accent-primary",border:"border-accent-primary/20",iconBg:"bg-accent-primary/10",badge:"bg-accent-primary/10 text-accent-primary text-xs font-semibold px-2 py-0.5 rounded-full"},buttermilk:{bg:"bg-accent-secondary/10",text:"text-accent-secondary-fg",border:"border-accent-secondary/20",iconBg:"bg-accent-secondary/20",badge:"bg-accent-secondary/10 text-accent-secondary-fg text-xs font-semibold px-2 py-0.5 rounded-full"},sky:{bg:"bg-accent-tertiary/10",text:"text-accent-tertiary",border:"border-accent-tertiary/20",iconBg:"bg-accent-tertiary/10",badge:"bg-accent-tertiary/10 text-accent-tertiary text-xs font-semibold px-2 py-0.5 rounded-full"}};return e.jsxs("div",{className:"space-y-8 animate-fade-in pb-12",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-textMain mb-2",children:"Dashboard Overview"}),e.jsx("p",{className:"text-textMuted",children:"Welcome back to your control panel."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(g,{to:"/admin/submissions",className:"p-4 bg-accent-secondary/10 border border-accent-secondary/20 rounded-xl hover:bg-accent-secondary/20 transition-colors group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-accent-secondary-fg font-bold text-lg",children:t.pendingSubmissions||0}),e.jsx("p",{className:"text-textMuted text-sm",children:"Pending Submissions"})]}),e.jsx(b,{className:"text-accent-secondary-fg",size:24})]})}),e.jsx(g,{to:"/admin/orders",className:"p-4 bg-accent-tertiary/10 border border-accent-tertiary/20 rounded-xl hover:bg-accent-tertiary/20 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-accent-tertiary font-bold text-lg",children:t.totalOrders||0}),e.jsx("p",{className:"text-textMuted text-sm",children:"Total Orders"})]}),e.jsx($,{className:"text-accent-tertiary",size:24})]})}),e.jsx(g,{to:"/admin/disputes",className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl hover:bg-red-500/20 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-bold text-lg",children:"View"}),e.jsx("p",{className:"text-textMuted text-sm",children:"Open Disputes"})]}),e.jsx(E,{className:"text-red-400",size:24})]})}),e.jsx(g,{to:"/admin/messages",className:"p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl hover:bg-blue-500/20 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-400 font-bold text-lg",children:"View"}),e.jsx("p",{className:"text-textMuted text-sm",children:"Contact Messages"})]}),e.jsx(K,{className:"text-blue-400",size:24})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:m.map(s=>{const a=s.icon,i=l[s.color];return e.jsxs("div",{className:`p-6 rounded-2xl bg-surface border border-border hover:${i.border} transition-all hover:shadow-lg hover:shadow-accent-primary/5 group`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${i.iconBg} ${i.text} border border-transparent`,children:e.jsx(a,{size:24,strokeWidth:2})}),e.jsxs("div",{className:`flex items-center gap-1 ${i.badge}`,children:[e.jsx(p,{size:12}),e.jsx("span",{children:s.trend})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-4xl font-display font-bold text-textMain mb-1 tracking-tight",children:s.value}),e.jsx("p",{className:"text-textMuted text-sm font-medium flex items-center gap-2",children:s.label})]})]},s.label)})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-display font-bold text-textMain mb-4",children:"Marketplace Commerce"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:f.map(s=>{const a=s.icon,i=l[s.color];return e.jsxs("div",{className:`p-6 rounded-2xl bg-surface border border-border hover:${i.border} transition-all hover:shadow-lg hover:shadow-accent-primary/5 group`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${i.iconBg} ${i.text} border border-transparent`,children:e.jsx(a,{size:24,strokeWidth:2})}),e.jsxs("div",{className:`flex items-center gap-1 ${i.badge}`,children:[e.jsx(p,{size:12}),e.jsx("span",{children:s.trend})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-4xl font-display font-bold text-textMain mb-1 tracking-tight",children:s.value}),e.jsx("p",{className:"text-textMuted text-sm font-medium flex items-center gap-2",children:s.label})]})]},s.label)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 p-8 rounded-2xl bg-surface border border-border relative overflow-hidden group hover:border-accent-primary/30 transition-all",children:[e.jsx("div",{className:"absolute top-0 right-0 p-32 bg-accent-primary/5 rounded-full blur-3xl -mr-16 -mt-16 transition-all group-hover:bg-accent-primary/10"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h2",{className:"text-xl font-bold text-textMain mb-2",children:"Submissions Queue"}),e.jsxs("p",{className:"text-textMuted mb-6 max-w-md",children:["You have ",t.pendingSubmissions||0," new kit submissions waiting for review. Process them to keep the marketplace fresh."]}),e.jsxs("a",{href:"/admin/submissions",className:"inline-flex items-center gap-2 px-6 py-3 bg-accent-primary text-accent-primary-fg rounded-xl font-medium hover:brightness-110 transition-all shadow-lg shadow-accent-primary/20 transform hover:-translate-y-0.5",children:[e.jsx(b,{size:18}),"Review Pending Items",e.jsx(N,{size:16})]})]})]}),e.jsxs("div",{className:"p-8 rounded-2xl bg-surface border border-border flex flex-col justify-between relative overflow-hidden group hover:border-accent-tertiary/30 transition-all",children:[e.jsx("div",{className:"absolute bottom-0 left-0 p-24 bg-accent-tertiary/5 rounded-full blur-2xl -ml-12 -mb-12"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-textMain mb-2",children:"Quick Access"}),e.jsx("p",{className:"text-sm text-textMuted mb-6",children:"Manage your platform resources"})]}),e.jsxs("div",{className:"space-y-3 relative z-10",children:[e.jsxs("a",{href:"/admin/kits",className:"flex items-center justify-between p-3 rounded-xl bg-surfaceHighlight border border-border hover:border-accent-primary/50 transition-colors group/item",children:[e.jsxs("span",{className:"text-sm font-medium text-textMain flex items-center gap-2",children:[e.jsx(y,{size:16,className:"text-accent-primary"}),"Manage Live Kits"]}),e.jsx(N,{size:14,className:"text-textMuted group-hover/item:text-accent-primary group-hover/item:translate-x-0.5 transition-all"})]}),e.jsxs("a",{href:"/admin/users",className:"flex items-center justify-between p-3 rounded-xl bg-surfaceHighlight border border-border hover:border-accent-tertiary/50 transition-colors group/item",children:[e.jsxs("span",{className:"text-sm font-medium text-textMain flex items-center gap-2",children:[e.jsx(w,{size:16,className:"text-accent-tertiary"}),"View User Database"]}),e.jsx(N,{size:14,className:"text-textMuted group-hover/item:text-accent-tertiary group-hover/item:translate-x-0.5 transition-all"})]})]})]})]})]})};export{F as default};
