import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as d,L as C,h as p,aH as _,x as z,aN as L,ag as T,P as k,o as A}from"./vendor-icons-BBHJ0ezg.js";import{u as F,c as $}from"./useTickets-DIdC8N1E.js";import{L as q}from"./vendor-react-Ojr5pEEK.js";import"./index-76QHltB_.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const B=()=>{const[l,h]=d.useState("open"),[r,g]=d.useState("all"),[c,f]=d.useState(null),{tickets:i,isLoading:b,error:n,refetch:j}=F({status:l,isAdmin:!0}),{updateStatus:N,isLoading:v}=$(),a=r==="all"?i:i.filter(t=>t.source===r||!t.source&&r==="order"),M=t=>{switch(t){case"open":return"bg-blue-500/10 text-blue-400 border-blue-500/20";case"waiting":return"bg-amber-500/10 text-amber-400 border-amber-500/20";case"under_review":return"bg-purple-500/10 text-purple-400 border-purple-500/20";case"resolved":return"bg-green-500/10 text-green-400 border-green-500/20";default:return"bg-surfaceHighlight text-textMuted border-border"}},x=t=>{switch(t){case"contact_us":return e.jsx(A,{size:12,className:"text-blue-400"});case"order":return e.jsx(k,{size:12,className:"text-green-400"});case"dispute":return e.jsx(T,{size:12,className:"text-red-400"});case"refund":return e.jsx(L,{size:12,className:"text-amber-400"});default:return e.jsx(p,{size:12,className:"text-textMuted"})}},o=t=>{switch(t){case"contact_us":return"Contact Form";case"order":return"Order";case"dispute":return"Dispute";case"refund":return"Refund";default:return"Direct"}},y=t=>{switch(t){case"urgent":return"text-red-400";case"high":return"text-amber-400";case"normal":return"text-textMuted";case"low":return"text-textMuted/50";default:return"text-textMuted"}},w=t=>{switch(t){case"delivery_issue":return"Delivery Issue";case"clarification":return"Clarification";case"refund_request":return"Refund Request";case"technical":return"Technical";default:return"Other"}},S=async(t,s)=>{(await N(t,s)).success&&(j(),(c==null?void 0:c.id)===t&&f(m=>m?{...m,status:s}:null))},u=(t,s)=>s===t?"bg-accent-tertiary text-textInverse shadow-lg":"bg-surface text-textMuted hover:text-textMain hover:bg-surfaceHighlight border border-border";return b?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(C,{className:"animate-spin text-accent-primary",size:32})}):e.jsxs("div",{className:"space-y-8 animate-fade-in pb-12",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-textMain mb-2",children:"Support Tickets"}),e.jsx("p",{className:"text-textMuted",children:"Manage user support requests"})]}),e.jsx("div",{className:"flex items-center gap-2 text-sm",children:e.jsxs("span",{className:"text-textMuted",children:[a.length," tickets"]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-textMuted uppercase tracking-wider mr-2 self-center",children:"Status:"}),["all","open","waiting","under_review","resolved"].map(t=>e.jsx("button",{onClick:()=>h(t),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${u(t,l)}`,children:t==="all"?"All":t.replace("_"," ").replace(/\b\w/g,s=>s.toUpperCase())},t))]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-textMuted uppercase tracking-wider mr-2 self-center",children:"Source:"}),["all","contact_us","order","dispute","refund"].map(t=>e.jsxs("button",{onClick:()=>g(t),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all flex items-center gap-1.5 ${u(t,r)}`,children:[t!=="all"&&x(t),t==="all"?"All Sources":o(t)]},t))]})]}),n&&e.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-xl text-red-400",children:n}),!n&&a.length===0&&e.jsxs("div",{className:"text-center py-20 bg-surface border border-border rounded-2xl",children:[e.jsx(p,{size:48,className:"mx-auto text-textMuted mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-textMain mb-2",children:"No tickets found"}),e.jsx("p",{className:"text-textMuted",children:l==="all"&&r==="all"?"No support tickets have been created yet.":"No matching tickets for the selected filters."})]}),a.length>0&&e.jsx("div",{className:"bg-surface border border-border rounded-2xl overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-surfaceHighlight border-b border-border",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Ticket"}),e.jsx("th",{className:"text-left p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Source"}),e.jsx("th",{className:"text-left p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"text-left p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"text-center p-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:a.map(t=>e.jsxs("tr",{className:"hover:bg-surfaceHighlight/50 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-mono text-textMuted",children:t.ticket_number}),e.jsxs("span",{className:`text-xs ${y(t.priority)}`,children:[t.priority==="urgent"&&"ðŸ”´",t.priority==="high"&&"ðŸŸ "]})]}),e.jsx("p",{className:"font-medium text-textMain truncate max-w-[250px]",children:t.subject}),t.creator&&e.jsxs("p",{className:"text-xs text-textMuted mt-1",children:["by ",t.creator.full_name]}),t.contact_email&&!t.creator&&e.jsxs("p",{className:"text-xs text-textMuted mt-1",children:["ðŸ“§ ",t.contact_email]})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[x(t.source||"order"),e.jsx("span",{className:"text-xs text-textMuted",children:o(t.source||"order")})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`text-sm ${t.category==="refund_request"?"text-red-400 font-medium":"text-textMuted"}`,children:w(t.category)})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium border ${M(t.status)}`,children:t.status.replace("_"," ")})}),e.jsx("td",{className:"p-4 text-sm text-textMuted",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(q,{to:`/tickets/${t.id}`,className:"p-2 text-textMuted hover:text-accent-primary hover:bg-accent-primary/10 rounded-lg transition-colors",title:"View Ticket",children:e.jsx(_,{size:16})}),t.status!=="resolved"&&e.jsx("button",{onClick:()=>S(t.id,"resolved"),disabled:v,className:"p-2 text-textMuted hover:text-green-400 hover:bg-green-500/10 rounded-lg transition-colors disabled:opacity-50",title:"Mark Resolved",children:e.jsx(z,{size:16})})]})})]},t.id))})]})})]})};export{B as default};
