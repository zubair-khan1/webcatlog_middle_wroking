import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as u,L as h,ax as y,aM as w,I as k,aP as M}from"./vendor-icons-BBHJ0ezg.js";import{B as v,s as x,z as b}from"./index-76QHltB_.js";import{e as S,u as C}from"./vendor-react-Ojr5pEEK.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const T=()=>{const{id:i}=S(),c=C(),l=!!i&&i!=="new",[j,N]=u.useState(l),[m,g]=u.useState(!1),[t,o]=u.useState({title:"",slug:"",excerpt:"",content:"",cover_image:"",tags:"",seo_title:"",seo_description:"",is_published:!1});u.useEffect(()=>{l&&(async()=>{var n;const{data:r,error:a}=await x.from("blog_posts").select("*").eq("id",i).single();a?(b.error("Failed to load post"),c("/admin/blog")):r&&o({title:r.title,slug:r.slug,excerpt:r.excerpt||"",content:r.content||"",cover_image:r.cover_image||"",tags:((n=r.tags)==null?void 0:n.join(", "))||"",seo_title:r.seo_title||"",seo_description:r.seo_description||"",is_published:r.is_published}),N(!1)})()},[i,l,c]);const p=s=>s.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),_=s=>{const r=s.target.value;o(a=>({...a,title:r,slug:!l&&a.slug===p(a.title)?p(r):a.slug}))},f=async(s=!1)=>{var n;if(!t.title||!t.slug){b.error("Title and Slug are required");return}g(!0);const r={title:t.title,slug:t.slug,excerpt:t.excerpt,content:t.content,cover_image:t.cover_image,tags:t.tags.split(",").map(d=>d.trim()).filter(Boolean),seo_title:t.seo_title,seo_description:t.seo_description,is_published:s?!0:t.is_published,published_at:s?new Date().toISOString():void 0,updated_at:new Date().toISOString()};let a;if(l){const{error:d}=await x.from("blog_posts").update(r).eq("id",i);a=d}else{const{error:d}=await x.from("blog_posts").insert([{...r,author_id:(n=(await x.auth.getUser()).data.user)==null?void 0:n.id}]);a=d}g(!1),a?(console.error(a),b.error("Failed to save post")):(b.success("Post saved successfully"),c("/admin/blog"))};return j?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(h,{className:"animate-spin text-accent-primary",size:32})}):e.jsxs("div",{className:"p-8 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 sticky top-0 bg-background/95 backdrop-blur z-10 py-4 border-b border-border",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>c("/admin/blog"),className:"text-textMuted hover:text-textMain",children:e.jsx(y,{size:24})}),e.jsx("h1",{className:"text-2xl font-bold text-textMain",children:l?"Edit Post":"New Post"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(v,{variant:"outline",onClick:()=>f(!1),disabled:m,children:"Save Draft"}),e.jsxs(v,{onClick:()=>f(!0),disabled:m,children:[m?e.jsx(h,{className:"animate-spin",size:18}):e.jsx(w,{size:18,className:"mr-2"}),t.is_published?"Update & Publish":"Publish Now"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-6",children:[e.jsx("label",{className:"block text-sm font-bold text-textMain mb-2",children:"Post Title"}),e.jsx("input",{type:"text",value:t.title,onChange:_,className:"w-full bg-background border border-border rounded-lg px-4 py-3 text-lg font-bold focus:outline-none focus:border-accent-primary mb-4",placeholder:"Enter post title..."}),e.jsx("label",{className:"block text-sm font-bold text-textMain mb-2",children:"Slug (URL)"}),e.jsx("input",{type:"text",value:t.slug,onChange:s=>o({...t,slug:s.target.value}),className:"w-full bg-background border border-border rounded-lg px-4 py-2 text-textMuted font-mono text-sm focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-6 min-h-[500px]",children:[e.jsx("label",{className:"block text-sm font-bold text-textMain mb-2",children:"Content (Markdown)"}),e.jsx("textarea",{value:t.content,onChange:s=>o({...t,content:s.target.value}),className:"w-full h-[600px] bg-background border border-border rounded-lg p-4 font-mono text-sm leading-relaxed focus:outline-none focus:border-accent-primary resize-none",placeholder:"# Write your masterpiece..."}),e.jsx("p",{className:"text-xs text-textMuted mt-2 text-right",children:"Markdown Supported"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-6",children:[e.jsxs("h3",{className:"font-bold text-textMain mb-4 flex items-center gap-2",children:[e.jsx(k,{size:18})," Cover Image"]}),e.jsx("input",{type:"text",value:t.cover_image,onChange:s=>o({...t,cover_image:s.target.value}),className:"w-full bg-background border border-border rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent-primary mb-4",placeholder:"https://example.com/image.jpg"}),t.cover_image&&e.jsx("div",{className:"aspect-video rounded-lg overflow-hidden bg-surfaceHighlight",children:e.jsx("img",{src:t.cover_image,alt:"Cover",className:"w-full h-full object-cover"})})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-6",children:[e.jsx("h3",{className:"font-bold text-textMain mb-4",children:"Excerpt"}),e.jsx("textarea",{value:t.excerpt,onChange:s=>o({...t,excerpt:s.target.value}),className:"w-full h-24 bg-background border border-border rounded-lg p-3 text-sm resize-none focus:outline-none focus:border-accent-primary",placeholder:"Short summary for cards..."})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-6",children:[e.jsxs("h3",{className:"font-bold text-textMain mb-4 flex items-center gap-2",children:[e.jsx(M,{size:18})," Tags"]}),e.jsx("input",{type:"text",value:t.tags,onChange:s=>o({...t,tags:s.target.value}),className:"w-full bg-background border border-border rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent-primary",placeholder:"tech, marketing, tutorial (comma separated)"})]}),e.jsxs("div",{className:"bg-surface border border-border rounded-xl p-6",children:[e.jsx("h3",{className:"font-bold text-textMain mb-4",children:"SEO Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-textMuted mb-1",children:"Meta Title"}),e.jsx("input",{type:"text",value:t.seo_title,onChange:s=>o({...t,seo_title:s.target.value}),className:"w-full bg-background border border-border rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-textMuted mb-1",children:"Meta Description"}),e.jsx("textarea",{value:t.seo_description,onChange:s=>o({...t,seo_description:s.target.value}),className:"w-full h-20 bg-background border border-border rounded-lg p-3 text-sm resize-none focus:outline-none focus:border-accent-primary"})]})]})]})]})]})]})};export{T as default};
