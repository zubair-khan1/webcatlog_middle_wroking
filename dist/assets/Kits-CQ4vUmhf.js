import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as i,L as y,P as g,J as v,x as j,aH as b,aG as N,aZ as w,av as _}from"./vendor-icons-BBHJ0ezg.js";import{s as n}from"./index-76QHltB_.js";import"./vendor-react-Ojr5pEEK.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const M=()=>{const[u,x]=i.useState([]),[c,l]=i.useState(!0),[m,o]=i.useState(null),a=async()=>{try{l(!0),o(null);const{data:s,error:r}=await n.from("listings").select("id, title, description, price, image_url, category_id, tech_stack, is_live, is_featured, preview_url, likes_count, views_count, created_at, updated_at, moderation_status").order("created_at",{ascending:!1});if(r)throw r;x(s||[])}catch(s){o(s instanceof Error?s.message:"Failed to fetch kits")}finally{l(!1)}};return i.useEffect(()=>{a()},[]),{kits:u,isLoading:c,error:m,unpublishKit:async s=>{try{const{error:r}=await n.from("listings").update({is_live:!1,moderation_status:"unpublished",updated_at:new Date().toISOString()}).eq("id",s);if(r)throw r;return await a(),{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to unpublish"}}},publishKit:async s=>{try{const{error:r}=await n.from("listings").update({is_live:!0,moderation_status:"live",updated_at:new Date().toISOString()}).eq("id",s);if(r)throw r;return await a(),{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to publish"}}},updateKit:async(s,r)=>{try{const{error:t}=await n.from("listings").update(r).eq("id",s);if(t)throw t;return await a(),{success:!0}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to update"}}},toggleFeatured:async(s,r)=>{try{const{error:t}=await n.from("listings").update({is_featured:!r}).eq("id",s);if(t)throw t;return await a(),{success:!0}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Failed to toggle featured"}}},refetch:a}},L=()=>{const{kits:u,isLoading:x,error:c,unpublishKit:l,publishKit:m,toggleFeatured:o}=M(),[a,h]=i.useState("all"),[d,p]=i.useState(""),f=u.filter(t=>d&&!t.title.toLowerCase().includes(d.toLowerCase())?!1:a==="live"?t.is_live:a==="unpublished"?!t.is_live:!0),s=async t=>{t.is_live?await l(t.id):await m(t.id)};if(x)return e.jsx("div",{className:"flex items-center justify-center py-20 h-full",children:e.jsx(y,{className:"animate-spin text-accent-primary",size:32})});if(c)return e.jsx("div",{className:"p-6 bg-red-500/10 border border-red-500/20 rounded-xl",children:e.jsxs("p",{className:"text-red-500 font-medium",children:["Error: ",c]})});const r=t=>a===t?"bg-accent-tertiary text-textInverse shadow-lg shadow-accent-tertiary/25 ring-1 ring-accent-tertiary/20 transform scale-100":"bg-surface text-textMuted hover:text-textMain hover:bg-surfaceHighlight border border-border hover:border-accent-tertiary/30";return e.jsxs("div",{className:"space-y-8 animate-fade-in pb-12",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-textMain mb-2",children:"Live Kits"}),e.jsx("p",{className:"text-textMuted",children:"Manage your digital assets and their visibility across the platform."})]}),e.jsx("div",{className:"h-10 w-10 bg-accent-primary/10 rounded-xl flex items-center justify-center",children:e.jsx(g,{className:"text-accent-primary",size:20})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(v,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-textMuted"}),e.jsx("input",{type:"text",placeholder:"Search kits by name...",value:d,onChange:t=>p(t.target.value),className:"w-full pl-12 pr-4 py-3 bg-surface border border-border rounded-xl text-textMain placeholder:text-textMuted focus:outline-none focus:border-accent-tertiary transition-colors"})]}),e.jsx("div",{className:"flex gap-2 p-1 bg-surfaceHighlight/50 rounded-xl w-fit border border-border/50",children:["all","live","unpublished"].map(t=>e.jsx("button",{onClick:()=>h(t),className:`px-5 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 capitalize ${r(t)}`,children:t},t))})]}),f.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-center bg-surface border border-border border-dashed rounded-3xl",children:[e.jsx("div",{className:"w-16 h-16 bg-surfaceHighlight rounded-full flex items-center justify-center mb-4",children:e.jsx(g,{className:"text-textMuted",size:24})}),e.jsx("p",{className:"text-textMain font-medium text-lg",children:"No kits found"}),e.jsxs("p",{className:"text-textMuted text-sm",children:["No ",a!=="all"?a:""," kits match your criteria."]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:f.map(t=>e.jsxs("div",{className:"p-5 rounded-2xl bg-surface border border-border hover:border-accent-primary/30 transition-all group flex flex-col h-full hover:shadow-lg hover:shadow-accent-primary/5",children:[t.image_url&&e.jsxs("div",{className:"aspect-video rounded-xl overflow-hidden mb-5 bg-surfaceHighlight relative ring-1 ring-black/5 dark:ring-white/5",children:[e.jsx("img",{src:t.image_url,alt:t.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 ease-out"}),!t.is_live&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-[2px] flex items-center justify-center transition-opacity",children:e.jsx("span",{className:"text-white font-semibold bg-red-500/90 hover:bg-red-500 px-4 py-1.5 rounded-full text-sm shadow-sm backdrop-blur-md",children:"Unpublished"})})]}),e.jsxs("div",{className:"space-y-4 flex-1 flex flex-col",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsx("h3",{className:"font-display font-bold text-lg text-textMain line-clamp-1 group-hover:text-accent-primary transition-colors",children:t.title}),t.is_featured&&e.jsxs("span",{className:"px-2.5 py-1 rounded-full text-[10px] font-bold tracking-wide uppercase bg-accent-secondary/15 text-accent-secondary-fg border border-accent-secondary/20 flex items-center gap-1.5 shrink-0",children:[e.jsx(j,{size:10,strokeWidth:3}),"Featured"]})]}),e.jsx("p",{className:"text-sm text-textMuted line-clamp-2 leading-relaxed",children:t.description||"No description provided."})]}),e.jsxs("div",{className:"mt-auto pt-4 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs font-medium text-textMuted mb-4",children:[e.jsx("span",{className:"flex items-center gap-1.5 bg-surfaceHighlight px-2.5 py-1 rounded-md",children:e.jsxs("span",{className:"text-textMain font-bold ml-0.5",children:["₹",t.price]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"flex items-center gap-1.5",title:"Views",children:[e.jsx(b,{size:12,className:"opacity-70"}),t.views_count]}),e.jsxs("span",{className:"flex items-center gap-1.5",title:"Likes",children:[e.jsx("span",{className:"opacity-70",children:"❤️"}),t.likes_count]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>s(t),className:`flex-1 px-4 py-2.5 rounded-xl text-sm font-medium transition-all flex items-center justify-center gap-2 ${t.is_live?"bg-red-500/5 hover:bg-red-500/10 text-red-500 border border-transparent hover:border-red-500/20":"bg-accent-primary/10 hover:bg-accent-primary/20 text-accent-primary-dim border border-transparent hover:border-accent-primary/20"}`,children:[t.is_live?e.jsx(N,{size:16}):e.jsx(b,{size:16}),t.is_live?"Unpublish":"Publish"]}),e.jsxs("button",{onClick:()=>window.location.href=`/details/${t.id}`,className:"px-4 py-2.5 rounded-xl bg-accent-tertiary/10 hover:bg-accent-tertiary/20 text-accent-tertiary-dim border border-transparent hover:border-accent-tertiary/20 text-sm font-medium transition-all flex items-center gap-2",children:[e.jsx(w,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),e.jsx("button",{onClick:()=>o(t.id,t.is_featured),className:`px-3 py-2.5 rounded-xl text-sm font-medium transition-all flex items-center gap-1 ${t.is_featured?"bg-accent-secondary/20 text-accent-secondary-fg border border-accent-secondary/30":"bg-surfaceHighlight text-textMuted hover:text-accent-secondary-fg hover:bg-accent-secondary/10 border border-transparent hover:border-accent-secondary/20"}`,title:t.is_featured?"Remove from featured":"Mark as featured",children:e.jsx(_,{size:14,fill:t.is_featured?"currentColor":"none"})})]})]})]})]},t.id))})]})};export{L as default};
