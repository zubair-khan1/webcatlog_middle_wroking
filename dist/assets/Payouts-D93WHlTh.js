import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as c,D as h,aW as b,at as g,L as f,x as j,aX as A,aK as y,aB as B,X as P,ar as R}from"./vendor-icons-BBHJ0ezg.js";import{b as H}from"./useSeller-BnsEhuCD.js";import{a as $,b as F,c as I,d as U}from"./useRefundsAndWithdrawals-DUJgh36L.js";import{u as T}from"./vendor-react-Ojr5pEEK.js";import"./index-76QHltB_.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const Z=()=>{const N=T(),{isLoading:v}=H(),{balance:s,isLoading:w}=$(),{withdrawals:l,isLoading:M}=F(),{requestWithdrawal:_,isLoading:x}=I(),{bankDetails:a,isLoading:L}=U(),[S,d]=c.useState(!1),[n,m]=c.useState(""),[r,o]=c.useState("bank_transfer"),[u,k]=c.useState("");if(v||w||M||L)return e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-accent-primary border-t-transparent rounded-full"})});const W=t=>{switch(t){case"completed":return e.jsx(j,{size:16,className:"text-accent-primary"});case"failed":case"rejected":return e.jsx(R,{size:16,className:"text-red-500"});case"processing":return e.jsx("div",{className:"w-4 h-4 border-2 border-accent-tertiary border-t-transparent rounded-full animate-spin"});default:return e.jsx(g,{size:16,className:"text-accent-secondary"})}},z=t=>({pending:"bg-surfaceHighlight text-textMuted",scheduled:"bg-accent-secondary/10 text-accent-secondary-fg",processing:"bg-accent-tertiary/10 text-accent-tertiary",completed:"bg-accent-primary/10 text-accent-primary",failed:"bg-red-500/10 text-red-500",rejected:"bg-red-500/10 text-red-500"})[t]||"bg-surfaceHighlight text-textMuted",C=()=>{if(!a){window.confirm("You need to add bank details before withdrawing. Go to setup now?")&&N("/seller/bank");return}k(a.upi_id||""),o(a.upi_id?"upi":"bank_transfer"),d(!0)},q=async()=>{const t=parseFloat(n);if(!t||t<=0){alert("Please enter a valid amount");return}if(t>s.available){alert("Insufficient balance");return}const i=r==="upi"?{upi_id:u}:{bank_name:a==null?void 0:a.bank_name,account_number_last4:a==null?void 0:a.account_number_last4,account_holder:a==null?void 0:a.account_holder_name},p=await _(t,r,i);p.success?(d(!1),m(""),alert("Withdrawal request submitted! Admin will review shortly."),window.location.reload()):alert(p.error||"Failed to submit withdrawal request")};return e.jsxs("div",{className:"space-y-8 animate-fade-in pb-12",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-textMain mb-2",children:"Payouts"}),e.jsx("p",{className:"text-textMuted",children:"Track your earnings and request withdrawals"})]}),e.jsxs("button",{onClick:C,disabled:s.available<=0,className:"px-6 py-3 bg-accent-primary text-accent-primary-fg rounded-xl font-medium hover:brightness-110 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg shadow-accent-primary/20",children:[e.jsx(h,{size:18}),"Request Withdrawal"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"p-6 rounded-2xl bg-accent-primary/10 border border-accent-primary/20",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-accent-primary/20",children:e.jsx(b,{size:20,className:"text-accent-primary"})}),e.jsx("span",{className:"text-accent-primary font-medium",children:"Available"})]}),e.jsxs("p",{className:"text-3xl font-display font-bold text-accent-primary",children:["₹",s.available.toLocaleString()]}),e.jsx("p",{className:"text-sm text-accent-primary/70 mt-1",children:"Ready to withdraw"})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-surface border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-accent-secondary/10",children:e.jsx(g,{size:20,className:"text-accent-secondary"})}),e.jsx("span",{className:"text-textMuted font-medium",children:"Pending Orders"})]}),e.jsxs("p",{className:"text-3xl font-display font-bold text-textMain",children:["₹",s.pending.toLocaleString()]}),e.jsx("p",{className:"text-sm text-textMuted mt-1",children:"From recent orders"})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-surface border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-accent-tertiary/10",children:e.jsx(f,{size:20,className:"text-accent-tertiary animate-spin-slow"})}),e.jsx("span",{className:"text-textMuted font-medium",children:"Processing"})]}),e.jsxs("p",{className:"text-3xl font-display font-bold text-accent-tertiary",children:["₹",l.filter(t=>["pending","processing"].includes(t.status)).reduce((t,i)=>t+Number(i.amount),0).toLocaleString()]}),e.jsx("p",{className:"text-sm text-textMuted mt-1",children:"Withdrawals in progress"})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-surface border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-accent-primary/10",children:e.jsx(j,{size:20,className:"text-accent-primary"})}),e.jsx("span",{className:"text-textMuted font-medium",children:"Total Withdrawn"})]}),e.jsxs("p",{className:"text-3xl font-display font-bold text-accent-primary",children:["₹",s.withdrawn.toLocaleString()]}),e.jsx("p",{className:"text-sm text-textMuted mt-1",children:"All-time payouts"})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-surface border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-accent-tertiary/10",children:e.jsx(A,{size:20,className:"text-accent-tertiary"})}),e.jsx("span",{className:"text-textMuted font-medium",children:"Bank Account"})]}),a?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-textMain",children:a.bank_name}),e.jsxs("p",{className:"text-sm text-textMuted",children:["•••• ",a.account_number_last4]}),e.jsxs("a",{href:"/seller/bank",className:"text-xs text-accent-tertiary hover:underline mt-2 inline-flex items-center gap-1",children:["Update details ",e.jsx(y,{size:12})]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-textMuted mb-2",children:"No account added"}),e.jsxs("a",{href:"/seller/bank",className:"text-sm text-accent-tertiary hover:underline inline-flex items-center gap-1",children:["Add Bank Details ",e.jsx(y,{size:14})]})]})]})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-surface border border-border",children:[e.jsx("h2",{className:"text-lg font-bold text-textMain mb-6",children:"Withdrawal History"}),l.length===0?e.jsxs("div",{className:"text-center py-8 text-textMuted",children:[e.jsx(b,{size:32,className:"mx-auto mb-3 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No withdrawal requests yet"})]}):e.jsx("div",{className:"space-y-4",children:l.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-surfaceHighlight border border-border/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[W(t.status),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-textMain",children:["₹",Number(t.amount).toLocaleString()]}),e.jsxs("p",{className:"text-sm text-textMuted flex items-center gap-2",children:[e.jsx(B,{size:12}),new Date(t.created_at).toLocaleDateString(),t.payment_method&&` • ${t.payment_method.replace("_"," ")}`]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium capitalize ${z(t.status)}`,children:t.status}),t.admin_notes&&e.jsxs("p",{className:"text-xs text-textMuted mt-1 max-w-[200px] truncate",children:["Note: ",t.admin_notes]})]})]},t.id))})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-surface rounded-2xl border border-border max-w-md w-full shadow-2xl animate-slide-up",children:[e.jsxs("div",{className:"p-6 border-b border-border flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-display font-bold text-textMain",children:"Request Withdrawal"}),e.jsx("button",{onClick:()=>d(!1),className:"p-2 hover:bg-surfaceHighlight rounded-lg transition-colors",children:e.jsx(P,{size:20,className:"text-textMuted"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"p-4 bg-accent-primary/10 border border-accent-primary/20 rounded-xl text-center",children:[e.jsx("p",{className:"text-xs text-accent-primary uppercase mb-1",children:"Available Balance"}),e.jsxs("p",{className:"text-3xl font-bold text-accent-primary",children:["₹",s.available.toLocaleString()]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-textMuted uppercase",children:"Withdrawal Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-textMuted font-bold",children:"₹"}),e.jsx("input",{type:"number",value:n,onChange:t=>m(t.target.value),placeholder:"0.00",max:s.available,className:"w-full bg-surfaceHighlight border border-border rounded-lg pl-8 pr-4 py-3 text-textMain text-lg font-bold placeholder:text-textMuted focus:border-accent-primary focus:outline-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-textMuted uppercase",children:"Payment Method"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{type:"button",onClick:()=>o("bank_transfer"),className:`p-4 rounded-xl border text-center transition-all ${r==="bank_transfer"?"bg-accent-primary/10 border-accent-primary/30":"bg-surfaceHighlight border-border"}`,children:e.jsx("p",{className:`font-medium ${r==="bank_transfer"?"text-accent-primary":"text-textMain"}`,children:"Bank Transfer"})}),(a==null?void 0:a.upi_id)&&e.jsx("button",{type:"button",onClick:()=>o("upi"),className:`p-4 rounded-xl border text-center transition-all ${r==="upi"?"bg-accent-primary/10 border-accent-primary/30":"bg-surfaceHighlight border-border"}`,children:e.jsx("p",{className:`font-medium ${r==="upi"?"text-accent-primary":"text-textMain"}`,children:"UPI"})})]}),e.jsxs("p",{className:"text-xs text-textMuted mt-1",children:["Sending to: ",r==="upi"?u:`Bank Account ending in ${a==null?void 0:a.account_number_last4}`]})]}),e.jsx("button",{onClick:q,disabled:x||!n||parseFloat(n)<=0,className:"w-full py-4 bg-accent-primary text-accent-primary-fg rounded-xl font-bold hover:brightness-110 transition-all disabled:opacity-50 flex items-center justify-center gap-2 shadow-lg shadow-accent-primary/20",children:x?e.jsx(f,{size:20,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(h,{size:20}),"Request Withdrawal"]})}),e.jsx("p",{className:"text-xs text-textMuted text-center",children:"Withdrawals are typically processed within 24-48 hours."})]})]})})]})};export{Z as default};
