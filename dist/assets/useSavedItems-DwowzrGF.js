import{a as s}from"./vendor-icons-BBHJ0ezg.js";import{b as m,s as o}from"./index-76QHltB_.js";const w=()=>{const{user:e}=m(),[d,a]=s.useState([]),[l,r]=s.useState(new Set),[t,i]=s.useState(!0),[v,u]=s.useState(null),c=s.useCallback(async()=>{if(!e){a([]),r(new Set),i(!1);return}i(!0),u(null);try{const{data:n,error:f}=await o.from("saved_items").select(`
          *,
          listing:listings(*)
        `).eq("user_id",e.id).order("created_at",{ascending:!1});if(f)throw f;const g=n||[];a(g),r(new Set(g.map(S=>S.listing_id)))}catch(n){u(n instanceof Error?n.message:"Failed to fetch saved items")}finally{i(!1)}},[e]);return s.useEffect(()=>{c()},[c]),{savedItems:d,savedListingIds:l,isLoading:t,error:v,refetch:c}},I=()=>{const{user:e}=m(),[d,a]=s.useState(!1);return{toggleSave:async r=>{if(!e)return!1;a(!0);try{const{data:t}=await o.from("saved_items").select("id").eq("user_id",e.id).eq("listing_id",r).single();if(t){const i=t;return await o.from("saved_items").delete().eq("id",i.id),!1}else return await o.from("saved_items").insert({user_id:e.id,listing_id:r}),!0}catch(t){return console.error("Error toggling save:",t),!1}finally{a(!1)}},isLoading:d}};export{I as a,w as u};
