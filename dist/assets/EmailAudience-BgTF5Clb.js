import{j as e}from"./vendor-motion-Dl8lXUsH.js";import{a as r,o as x,L as p,n as S,b4 as M,b5 as _,J as C,ad as k,ag as L,x as E,ar as z}from"./vendor-icons-BBHJ0ezg.js";import{a as U,b as A,e as B}from"./useEmailAudience-CyQLlRDa.js";import{B as D}from"./index-76QHltB_.js";import"./vendor-react-Ojr5pEEK.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";const Q=()=>{const[l,h]=r.useState(""),[i,b]=r.useState(""),[n,j]=r.useState(""),[c,g]=r.useState(""),{stats:s,isLoading:N}=U(),{emails:d,isLoading:f,error:o}=A({search:l,source:i,user_type:n,status:c}),[y,u]=r.useState(!1),v=async()=>{u(!0);const t=await B({search:l,source:i,user_type:n,status:c});if(t.success&&t.csv){const w=new Blob([t.csv],{type:"text/csv"}),m=window.URL.createObjectURL(w),a=document.createElement("a");a.href=m,a.download=`email-audience-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(m)}u(!1)};return e.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-accent-primary/10 flex items-center justify-center",children:e.jsx(x,{size:20,className:"text-accent-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-textMain",children:"Email Audience"}),e.jsx("p",{className:"text-sm text-textSecondary",children:"Centralized email management & campaign intelligence"})]})]})}),N?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(p,{className:"animate-spin text-accent-primary",size:32})}):s?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-textMuted uppercase tracking-wider",children:"Total Emails"}),e.jsx(S,{size:16,className:"text-textMuted"})]}),e.jsx("div",{className:"text-3xl font-bold text-textMain",children:s.total_emails.toLocaleString()}),e.jsxs("div",{className:"text-xs text-textSecondary mt-1",children:[s.subscribed_count," subscribed"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-textMuted uppercase tracking-wider",children:"Newsletter"}),e.jsx(x,{size:16,className:"text-blue-500"})]}),e.jsx("div",{className:"text-3xl font-bold text-textMain",children:s.newsletter_count.toLocaleString()}),e.jsx("div",{className:"text-xs text-textSecondary mt-1",children:"Organic signups"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-textMuted uppercase tracking-wider",children:"Registered"}),e.jsx(M,{size:16,className:"text-green-500"})]}),e.jsx("div",{className:"text-3xl font-bold text-textMain",children:s.registered_count.toLocaleString()}),e.jsxs("div",{className:"text-xs text-textSecondary mt-1",children:[s.buyer_count," buyers, ",s.seller_count," sellers"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-5 border border-border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-textMuted uppercase tracking-wider",children:"Guests"}),e.jsx(_,{size:16,className:"text-orange-500"})]}),e.jsx("div",{className:"text-3xl font-bold text-textMain",children:s.guest_count.toLocaleString()}),e.jsx("div",{className:"text-xs text-textSecondary mt-1",children:"Not yet registered"})]})]}):null,e.jsx("div",{className:"bg-white rounded-xl p-6 border border-border shadow-sm mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-textMuted"}),e.jsx("input",{type:"text",placeholder:"Search by email...",value:l,onChange:t=>h(t.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-surfaceHighlight border border-border rounded-lg text-textMain placeholder:text-textMuted focus:border-accent-primary focus:outline-none focus:ring-1 focus:ring-accent-primary transition-all"})]})}),e.jsxs("select",{value:i,onChange:t=>b(t.target.value),className:"px-4 py-2.5 bg-surfaceHighlight border border-border rounded-lg text-textMain focus:border-accent-primary focus:outline-none transition-all",children:[e.jsx("option",{value:"",children:"All Sources"}),e.jsx("option",{value:"newsletter",children:"Newsletter"}),e.jsx("option",{value:"contact",children:"Contact Form"}),e.jsx("option",{value:"buyer_signup",children:"Buyer Signup"}),e.jsx("option",{value:"seller_signup",children:"Seller Signup"}),e.jsx("option",{value:"manual",children:"Manual"})]}),e.jsxs("select",{value:n,onChange:t=>j(t.target.value),className:"px-4 py-2.5 bg-surfaceHighlight border border-border rounded-lg text-textMain focus:border-accent-primary focus:outline-none transition-all",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"guest",children:"Guest"}),e.jsx("option",{value:"buyer",children:"Buyer"}),e.jsx("option",{value:"seller",children:"Seller"})]}),e.jsxs("select",{value:c,onChange:t=>g(t.target.value),className:"px-4 py-2.5 bg-surfaceHighlight border border-border rounded-lg text-textMain focus:border-accent-primary focus:outline-none transition-all",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"subscribed",children:"Subscribed"}),e.jsx("option",{value:"unsubscribed",children:"Unsubscribed"}),e.jsx("option",{value:"blocked",children:"Blocked"})]}),e.jsx(D,{variant:"outline",onClick:v,isLoading:y,icon:e.jsx(k,{size:16}),className:"whitespace-nowrap",children:"Export CSV"})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-border shadow-sm overflow-hidden",children:[o&&e.jsxs("div",{className:"p-4 bg-red-50 border-b border-red-100 flex items-center gap-3 text-red-600",children:[e.jsx(L,{size:18}),e.jsx("span",{className:"text-sm",children:o})]}),f?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(p,{className:"animate-spin text-accent-primary",size:32})}):d.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx(x,{size:48,className:"text-textMuted mx-auto mb-4 opacity-30"}),e.jsx("p",{className:"text-textSecondary",children:"No emails found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-surfaceHighlight border-b border-border",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Source"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Consent"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-bold text-textMuted uppercase tracking-wider",children:"Last Seen"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:d.map(t=>e.jsxs("tr",{className:"hover:bg-surfaceHighlight/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-textMain",children:t.email}),t.linked_user_id&&e.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-blue-50 text-blue-600 border border-blue-100",children:"LINKED"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 rounded-lg text-xs font-medium bg-surface text-textMain border border-border",children:t.source.replace("_"," ")})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${t.user_type==="seller"?"bg-purple-50 text-purple-700 border border-purple-100":t.user_type==="buyer"?"bg-green-50 text-green-700 border border-green-100":"bg-gray-50 text-gray-700 border border-gray-100"}`,children:t.user_type})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.status==="subscribed"?e.jsx(E,{size:14,className:"text-green-500"}):e.jsx(z,{size:14,className:"text-red-500"}),e.jsx("span",{className:"text-sm text-textMain capitalize",children:t.status})]})}),e.jsx("td",{className:"px-6 py-4",children:t.consent_flag?e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"Yes"}):e.jsx("span",{className:"text-xs text-textMuted",children:"No"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-textSecondary",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-sm text-textSecondary",children:new Date(t.last_seen_at).toLocaleDateString()})]},t.id))})]})})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between text-xs text-textMuted",children:[e.jsxs("span",{children:["Showing ",d.length," emails"]}),e.jsx("span",{children:"Campaign-ready â€¢ Export includes consent status"})]})]})};export{Q as default};
