import{a as r}from"./vendor-icons-BBHJ0ezg.js";import{b as E,s as m}from"./index-76QHltB_.js";const L=()=>{const{user:t,isAuthenticated:o}=E(),[d,n]=r.useState([]),[f,s]=r.useState(!0),[g,l]=r.useState(null),u=r.useCallback(async()=>{if(!o||!t){n([]),s(!1);return}s(!0),l(null);try{const{data:e,error:c}=await m.from("orders").select(`
          *,
          listing:listings(id, title, image_url, price),
          buyer:profiles!orders_buyer_id_fkey(id, full_name, avatar_url)
        `).eq("seller_id",t.id).order("created_at",{ascending:!1});if(c)throw c;n(e||[])}catch(e){console.error("[useSellerOrders] Error:",e),l(e instanceof Error?e.message:"Failed to fetch orders")}finally{s(!1)}},[t,o]);return r.useEffect(()=>{u()},[u]),{orders:d,isLoading:f,error:g,refetch:u}},P=()=>{const{user:t,isAuthenticated:o}=E(),[d,n]=r.useState([]),[f,s]=r.useState(!0),[g,l]=r.useState(null),u=r.useCallback(async()=>{if(!o||!t){n([]),s(!1);return}s(!0),l(null);try{const{data:e,error:c}=await m.from("seller_payouts").select("*").eq("seller_id",t.id).order("created_at",{ascending:!1});if(c)throw c;n(e||[])}catch(e){console.error("[useSellerPayouts] Error:",e),l(e instanceof Error?e.message:"Failed to fetch payouts")}finally{s(!1)}},[t,o]);return r.useEffect(()=>{u()},[u]),{payouts:d,isLoading:f,error:g,refetch:u}},q=()=>{const{user:t,isAuthenticated:o}=E(),[d,n]=r.useState(null),[f,s]=r.useState(!0),[g,l]=r.useState(null);return r.useEffect(()=>{(async()=>{if(!o||!t){n(null),s(!1);return}s(!0),l(null);try{const{data:e,error:c}=await m.from("orders").select("seller_amount, status").eq("seller_id",t.id).in("status",["paid","delivered","completed"]);if(c)throw c;const{data:i,error:y}=await m.from("seller_payouts").select("amount, status").eq("seller_id",t.id);if(y)throw y;const _=(e==null?void 0:e.reduce((a,h)=>a+Number(h.seller_amount),0))||0,p=(i==null?void 0:i.filter(a=>a.status==="completed").reduce((a,h)=>a+Number(h.amount),0))||0,S=(i==null?void 0:i.filter(a=>a.status==="pending"||a.status==="scheduled").reduce((a,h)=>a+Number(h.amount),0))||0;n({total_sales:(e==null?void 0:e.length)||0,total_earnings:_,pending_payouts:S,completed_payouts:p,orders_count:(e==null?void 0:e.length)||0})}catch(e){console.error("[useSellerEarnings] Error:",e),l(e instanceof Error?e.message:"Failed to fetch earnings")}finally{s(!1)}})()},[t,o]),{earnings:d,isLoading:f,error:g}};export{L as a,P as b,q as u};
