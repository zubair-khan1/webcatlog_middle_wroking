import{j as d}from"./vendor-motion-Dl8lXUsH.js";import{a as c,a2 as z,b6 as Yn,aG as Hn,b7 as Wn,aQ as Vn,aj as Gn,b8 as $t,a5 as Ft,I as Kt,b9 as qn,U as Xt,ax as Jn,ba as Qn,bb as Zn,a$ as er,bc as tr,aM as nr,am as rr,bd as Ut,aJ as or,X as Yt}from"./vendor-icons-BBHJ0ezg.js";import{r as ze,e as sr,u as ir}from"./vendor-react-Ojr5pEEK.js";import{s as Ht,z as Ge}from"./index-76QHltB_.js";import{S as ar,g as lr}from"./LayoutRenderer-Cd1hM_UA.js";import"./vendor-supabase-CIvuJI4W.js";import"./vendor-date-BvD7TL1z.js";import"./useSavedItems-DwowzrGF.js";function cr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const st=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ie(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function St(e){return"nodeType"in e}function q(e){var t,n;return e?Ie(e)?e:St(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Ct(e){const{Document:t}=q(e);return e instanceof t}function Xe(e){return Ie(e)?!1:e instanceof q(e).HTMLElement}function cn(e){return e instanceof q(e).SVGElement}function Me(e){return e?Ie(e)?e.document:St(e)?Ct(e)?e:Xe(e)||cn(e)?e.ownerDocument:document:document:document}const se=st?c.useLayoutEffect:c.useEffect;function it(e){const t=c.useRef(e);return se(()=>{t.current=e}),c.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function dr(){const e=c.useRef(null),t=c.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=c.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function $e(e,t){t===void 0&&(t=[e]);const n=c.useRef(e);return se(()=>{n.current!==e&&(n.current=e)},t),n}function Ue(e,t){const n=c.useRef();return c.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Ze(e){const t=it(e),n=c.useRef(null),r=c.useCallback(o=>{o!==n.current&&(t==null||t(o,n.current)),n.current=o},[]);return[n,r]}function et(e){const t=c.useRef();return c.useEffect(()=>{t.current=e},[e]),t.current}let gt={};function Ye(e,t){return c.useMemo(()=>{if(t)return t;const n=gt[e]==null?0:gt[e]+1;return gt[e]=n,e+"-"+n},[e,t])}function dn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((s,a)=>{const i=Object.entries(a);for(const[l,u]of i){const h=s[l];h!=null&&(s[l]=h+e*u)}return s},{...t})}}const je=dn(1),Fe=dn(-1);function ur(e){return"clientX"in e&&"clientY"in e}function at(e){if(!e)return!1;const{KeyboardEvent:t}=q(e.target);return t&&e instanceof t}function fr(e){if(!e)return!1;const{TouchEvent:t}=q(e.target);return t&&e instanceof t}function tt(e){if(fr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return ur(e)?{x:e.clientX,y:e.clientY}:null}const xe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[xe.Translate.toString(e),xe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Wt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function hr(e){return e.matches(Wt)?e:e.querySelector(Wt)}const gr={display:"none"};function pr(e){let{id:t,value:n}=e;return z.createElement("div",{id:t,style:gr},n)}function vr(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return z.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function br(){const[e,t]=c.useState("");return{announce:c.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const un=c.createContext(null);function mr(e){const t=c.useContext(un);c.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function xr(){const[e]=c.useState(()=>new Set),t=c.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[c.useCallback(r=>{let{type:o,event:s}=r;e.forEach(a=>{var i;return(i=a[o])==null?void 0:i.call(a,s)})},[e]),t]}const yr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},wr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Sr(e){let{announcements:t=wr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=yr}=e;const{announce:s,announcement:a}=br(),i=Ye("DndLiveRegion"),[l,u]=c.useState(!1);if(c.useEffect(()=>{u(!0)},[]),mr(c.useMemo(()=>({onDragStart(f){let{active:p}=f;s(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:g}=f;t.onDragMove&&s(t.onDragMove({active:p,over:g}))},onDragOver(f){let{active:p,over:g}=f;s(t.onDragOver({active:p,over:g}))},onDragEnd(f){let{active:p,over:g}=f;s(t.onDragEnd({active:p,over:g}))},onDragCancel(f){let{active:p,over:g}=f;s(t.onDragCancel({active:p,over:g}))}}),[s,t])),!l)return null;const h=z.createElement(z.Fragment,null,z.createElement(pr,{id:r,value:o.draggable}),z.createElement(vr,{id:i,announcement:a}));return n?ze.createPortal(h,n):h}var F;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(F||(F={}));function nt(){}function Vt(e,t){return c.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Cr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return c.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const ie=Object.freeze({x:0,y:0});function fn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Dr(e,t){const n=tt(e);if(!n)return"0 0";const r={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return r.x+"% "+r.y+"%"}function hn(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Rr(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Gt(e){let{left:t,top:n,height:r,width:o}=e;return[{x:t,y:n},{x:t+o,y:n},{x:t,y:n+r},{x:t+o,y:n+r}]}function gn(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function qt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Nr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=qt(t,t.left,t.top),s=[];for(const a of r){const{id:i}=a,l=n.get(i);if(l){const u=fn(qt(l),o);s.push({id:i,data:{droppableContainer:a,value:u}})}}return s.sort(hn)},Er=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Gt(t),s=[];for(const a of r){const{id:i}=a,l=n.get(i);if(l){const u=Gt(l),h=o.reduce((p,g,m)=>p+fn(u[m],g),0),f=Number((h/4).toFixed(4));s.push({id:i,data:{droppableContainer:a,value:f}})}}return s.sort(hn)};function jr(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),a=o-r,i=s-n;if(r<o&&n<s){const l=t.width*t.height,u=e.width*e.height,h=a*i,f=h/(l+u-h);return Number(f.toFixed(4))}return 0}const Ir=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const s of r){const{id:a}=s,i=n.get(a);if(i){const l=jr(i,t);l>0&&o.push({id:a,data:{droppableContainer:s,value:l}})}}return o.sort(Rr)};function Mr(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function pn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ie}function Ar(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o.reduce((a,i)=>({...a,top:a.top+e*i.y,bottom:a.bottom+e*i.y,left:a.left+e*i.x,right:a.right+e*i.x}),{...n})}}const Or=Ar(1);function vn(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function kr(e,t,n){const r=vn(t);if(!r)return e;const{scaleX:o,scaleY:s,x:a,y:i}=r,l=e.left-a-(1-o)*parseFloat(n),u=e.top-i-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),h=o?e.width/o:e.width,f=s?e.height/s:e.height;return{width:h,height:f,top:u,right:l+h,bottom:u+f,left:l}}const Tr={ignoreTransform:!1};function Ae(e,t){t===void 0&&(t=Tr);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:h}=q(e).getComputedStyle(e);u&&(n=kr(n,u,h))}const{top:r,left:o,width:s,height:a,bottom:i,right:l}=n;return{top:r,left:o,width:s,height:a,bottom:i,right:l}}function Jt(e){return Ae(e,{ignoreTransform:!0})}function Lr(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function zr(e,t){return t===void 0&&(t=q(e).getComputedStyle(e)),t.position==="fixed"}function Pr(e,t){t===void 0&&(t=q(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const s=t[o];return typeof s=="string"?n.test(s):!1})}function lt(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(Ct(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!Xe(o)||cn(o)||n.includes(o))return n;const s=q(e).getComputedStyle(o);return o!==e&&Pr(o,s)&&n.push(o),zr(o,s)?n:r(o.parentNode)}return e?r(e):n}function bn(e){const[t]=lt(e,1);return t??null}function pt(e){return!st||!e?null:Ie(e)?e:St(e)?Ct(e)||e===Me(e).scrollingElement?window:Xe(e)?e:null:null}function mn(e){return Ie(e)?e.scrollX:e.scrollLeft}function xn(e){return Ie(e)?e.scrollY:e.scrollTop}function xt(e){return{x:mn(e),y:xn(e)}}var X;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(X||(X={}));function yn(e){return!st||!e?!1:e===document.scrollingElement}function wn(e){const t={x:0,y:0},n=yn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,i=e.scrollLeft>=r.x;return{isTop:o,isLeft:s,isBottom:a,isRight:i,maxScroll:r,minScroll:t}}const _r={x:.2,y:.2};function Br(e,t,n,r,o){let{top:s,left:a,right:i,bottom:l}=n;r===void 0&&(r=10),o===void 0&&(o=_r);const{isTop:u,isBottom:h,isLeft:f,isRight:p}=wn(e),g={x:0,y:0},m={x:0,y:0},v={height:t.height*o.y,width:t.width*o.x};return!u&&s<=t.top+v.height?(g.y=X.Backward,m.y=r*Math.abs((t.top+v.height-s)/v.height)):!h&&l>=t.bottom-v.height&&(g.y=X.Forward,m.y=r*Math.abs((t.bottom-v.height-l)/v.height)),!p&&i>=t.right-v.width?(g.x=X.Forward,m.x=r*Math.abs((t.right-v.width-i)/v.width)):!f&&a<=t.left+v.width&&(g.x=X.Backward,m.x=r*Math.abs((t.left+v.width-a)/v.width)),{direction:g,speed:m}}function $r(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:a}=window;return{top:0,left:0,right:s,bottom:a,width:s,height:a}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function Sn(e){return e.reduce((t,n)=>je(t,xt(n)),ie)}function Fr(e){return e.reduce((t,n)=>t+mn(n),0)}function Kr(e){return e.reduce((t,n)=>t+xn(n),0)}function Cn(e,t){if(t===void 0&&(t=Ae),!e)return;const{top:n,left:r,bottom:o,right:s}=t(e);bn(e)&&(o<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Xr=[["x",["left","right"],Fr],["y",["top","bottom"],Kr]];class Dt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=lt(n),o=Sn(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,a,i]of Xr)for(const l of a)Object.defineProperty(this,l,{get:()=>{const u=i(r),h=o[s]-u;return this.rect[l]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Pe{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Ur(e){const{EventTarget:t}=q(e);return e instanceof t?e:Me(e)}function vt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var oe;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(oe||(oe={}));function Qt(e){e.preventDefault()}function Yr(e){e.stopPropagation()}var E;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(E||(E={}));const Dn={start:[E.Space,E.Enter],cancel:[E.Esc],end:[E.Space,E.Enter,E.Tab]},Hr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case E.Right:return{...n,x:n.x+25};case E.Left:return{...n,x:n.x-25};case E.Down:return{...n,y:n.y+25};case E.Up:return{...n,y:n.y-25}}};class Rt{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Pe(Me(n)),this.windowListeners=new Pe(q(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(oe.Resize,this.handleCancel),this.windowListeners.add(oe.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(oe.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Cn(r),n(ie)}handleKeyDown(t){if(at(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:s=Dn,coordinateGetter:a=Hr,scrollBehavior:i="smooth"}=o,{code:l}=t;if(s.end.includes(l)){this.handleEnd(t);return}if(s.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:u}=r.current,h=u?{x:u.left,y:u.top}:ie;this.referenceCoordinates||(this.referenceCoordinates=h);const f=a(t,{active:n,context:r.current,currentCoordinates:h});if(f){const p=Fe(f,h),g={x:0,y:0},{scrollableAncestors:m}=r.current;for(const v of m){const b=t.code,{isTop:y,isRight:w,isLeft:x,isBottom:D,maxScroll:R,minScroll:j}=wn(v),S=$r(v),C={x:Math.min(b===E.Right?S.right-S.width/2:S.right,Math.max(b===E.Right?S.left:S.left+S.width/2,f.x)),y:Math.min(b===E.Down?S.bottom-S.height/2:S.bottom,Math.max(b===E.Down?S.top:S.top+S.height/2,f.y))},O=b===E.Right&&!w||b===E.Left&&!x,P=b===E.Down&&!D||b===E.Up&&!y;if(O&&C.x!==f.x){const M=v.scrollLeft+p.x,H=b===E.Right&&M<=R.x||b===E.Left&&M>=j.x;if(H&&!p.y){v.scrollTo({left:M,behavior:i});return}H?g.x=v.scrollLeft-M:g.x=b===E.Right?v.scrollLeft-R.x:v.scrollLeft-j.x,g.x&&v.scrollBy({left:-g.x,behavior:i});break}else if(P&&C.y!==f.y){const M=v.scrollTop+p.y,H=b===E.Down&&M<=R.y||b===E.Up&&M>=j.y;if(H&&!p.x){v.scrollTo({top:M,behavior:i});return}H?g.y=v.scrollTop-M:g.y=b===E.Down?v.scrollTop-R.y:v.scrollTop-j.y,g.y&&v.scrollBy({top:-g.y,behavior:i});break}}this.handleMove(t,je(Fe(f,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Rt.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Dn,onActivation:o}=t,{active:s}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const i=s.activatorNode.current;return i&&e.target!==i?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];function Zt(e){return!!(e&&"distance"in e)}function en(e){return!!(e&&"delay"in e)}class Nt{constructor(t,n,r){var o;r===void 0&&(r=Ur(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:a}=s;this.props=t,this.events=n,this.document=Me(a),this.documentListeners=new Pe(this.document),this.listeners=new Pe(r),this.windowListeners=new Pe(q(a)),this.initialCoordinates=(o=tt(s))!=null?o:ie,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(oe.Resize,this.handleCancel),this.windowListeners.add(oe.DragStart,Qt),this.windowListeners.add(oe.VisibilityChange,this.handleCancel),this.windowListeners.add(oe.ContextMenu,Qt),this.documentListeners.add(oe.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(en(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Zt(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(oe.Click,Yr,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(oe.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:s}=this,{onMove:a,options:{activationConstraint:i}}=s;if(!o)return;const l=(n=tt(t))!=null?n:ie,u=Fe(o,l);if(!r&&i){if(Zt(i)){if(i.tolerance!=null&&vt(u,i.tolerance))return this.handleCancel();if(vt(u,i.distance))return this.handleStart()}if(en(i)&&vt(u,i.tolerance))return this.handleCancel();this.handlePending(i,u);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===E.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Wr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Et extends Nt{constructor(t){const{event:n}=t,r=Me(n.target);super(t,Wr,r)}}Et.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Vr={move:{name:"mousemove"},end:{name:"mouseup"}};var yt;(function(e){e[e.RightClick=2]="RightClick"})(yt||(yt={}));class Gr extends Nt{constructor(t){super(t,Vr,Me(t.event.target))}}Gr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===yt.RightClick?!1:(r==null||r({event:n}),!0)}}];const bt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class qr extends Nt{constructor(t){super(t,bt)}static setup(){return window.addEventListener(bt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(bt.move.name,t)};function t(){}}}qr.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r==null||r({event:n}),!0)}}];var _e;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(_e||(_e={}));var rt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(rt||(rt={}));function Jr(e){let{acceleration:t,activator:n=_e.Pointer,canScroll:r,draggingRect:o,enabled:s,interval:a=5,order:i=rt.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:h,delta:f,threshold:p}=e;const g=Zr({delta:f,disabled:!s}),[m,v]=dr(),b=c.useRef({x:0,y:0}),y=c.useRef({x:0,y:0}),w=c.useMemo(()=>{switch(n){case _e.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case _e.DraggableRect:return o}},[n,o,l]),x=c.useRef(null),D=c.useCallback(()=>{const j=x.current;if(!j)return;const S=b.current.x*y.current.x,C=b.current.y*y.current.y;j.scrollBy(S,C)},[]),R=c.useMemo(()=>i===rt.TreeOrder?[...u].reverse():u,[i,u]);c.useEffect(()=>{if(!s||!u.length||!w){v();return}for(const j of R){if((r==null?void 0:r(j))===!1)continue;const S=u.indexOf(j),C=h[S];if(!C)continue;const{direction:O,speed:P}=Br(j,C,w,t,p);for(const M of["x","y"])g[M][O[M]]||(P[M]=0,O[M]=0);if(P.x>0||P.y>0){v(),x.current=j,m(D,a),b.current=P,y.current=O;return}}b.current={x:0,y:0},y.current={x:0,y:0},v()},[t,D,r,v,s,a,JSON.stringify(w),JSON.stringify(g),m,u,R,h,JSON.stringify(p)])}const Qr={x:{[X.Backward]:!1,[X.Forward]:!1},y:{[X.Backward]:!1,[X.Forward]:!1}};function Zr(e){let{delta:t,disabled:n}=e;const r=et(t);return Ue(o=>{if(n||!r||!o)return Qr;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[X.Backward]:o.x[X.Backward]||s.x===-1,[X.Forward]:o.x[X.Forward]||s.x===1},y:{[X.Backward]:o.y[X.Backward]||s.y===-1,[X.Forward]:o.y[X.Forward]||s.y===1}}},[n,t,r])}function eo(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ue(o=>{var s;return t==null?null:(s=r??o)!=null?s:null},[r,t])}function to(e,t){return c.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,s=o.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...s]},[]),[e,t])}var Ke;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ke||(Ke={}));var wt;(function(e){e.Optimized="optimized"})(wt||(wt={}));const tn=new Map;function no(e,t){let{dragging:n,dependencies:r,config:o}=t;const[s,a]=c.useState(null),{frequency:i,measure:l,strategy:u}=o,h=c.useRef(e),f=b(),p=$e(f),g=c.useCallback(function(y){y===void 0&&(y=[]),!p.current&&a(w=>w===null?y:w.concat(y.filter(x=>!w.includes(x))))},[p]),m=c.useRef(null),v=Ue(y=>{if(f&&!n)return tn;if(!y||y===tn||h.current!==e||s!=null){const w=new Map;for(let x of e){if(!x)continue;if(s&&s.length>0&&!s.includes(x.id)&&x.rect.current){w.set(x.id,x.rect.current);continue}const D=x.node.current,R=D?new Dt(l(D),D):null;x.rect.current=R,R&&w.set(x.id,R)}return w}return y},[e,s,n,f,l]);return c.useEffect(()=>{h.current=e},[e]),c.useEffect(()=>{f||g()},[n,f]),c.useEffect(()=>{s&&s.length>0&&a(null)},[JSON.stringify(s)]),c.useEffect(()=>{f||typeof i!="number"||m.current!==null||(m.current=setTimeout(()=>{g(),m.current=null},i))},[i,f,g,...r]),{droppableRects:v,measureDroppableContainers:g,measuringScheduled:s!=null};function b(){switch(u){case Ke.Always:return!1;case Ke.BeforeDragging:return n;default:return!n}}}function jt(e,t){return Ue(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function ro(e,t){return jt(e,t)}function oo(e){let{callback:t,disabled:n}=e;const r=it(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return c.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function ct(e){let{callback:t,disabled:n}=e;const r=it(t),o=c.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return c.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function so(e){return new Dt(Ae(e),e)}function nn(e,t,n){t===void 0&&(t=so);const[r,o]=c.useState(null);function s(){o(l=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=l??n)!=null?u:null}const h=t(e);return JSON.stringify(l)===JSON.stringify(h)?l:h})}const a=oo({callback(l){if(e)for(const u of l){const{type:h,target:f}=u;if(h==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),i=ct({callback:s});return se(()=>{s(),e?(i==null||i.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(i==null||i.disconnect(),a==null||a.disconnect())},[e]),r}function io(e){const t=jt(e);return pn(e,t)}const rn=[];function ao(e){const t=c.useRef(e),n=Ue(r=>e?r&&r!==rn&&e&&t.current&&e.parentNode===t.current.parentNode?r:lt(e):rn,[e]);return c.useEffect(()=>{t.current=e},[e]),n}function lo(e){const[t,n]=c.useState(null),r=c.useRef(e),o=c.useCallback(s=>{const a=pt(s.target);a&&n(i=>i?(i.set(a,xt(a)),new Map(i)):null)},[]);return c.useEffect(()=>{const s=r.current;if(e!==s){a(s);const i=e.map(l=>{const u=pt(l);return u?(u.addEventListener("scroll",o,{passive:!0}),[u,xt(u)]):null}).filter(l=>l!=null);n(i.length?new Map(i):null),r.current=e}return()=>{a(e),a(s)};function a(i){i.forEach(l=>{const u=pt(l);u==null||u.removeEventListener("scroll",o)})}},[o,e]),c.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,a)=>je(s,a),ie):Sn(e):ie,[e,t])}function on(e,t){t===void 0&&(t=[]);const n=c.useRef(null);return c.useEffect(()=>{n.current=null},t),c.useEffect(()=>{const r=e!==ie;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Fe(e,n.current):ie}function co(e){c.useEffect(()=>{if(!st)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function uo(e,t){return c.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:s}=r;return n[o]=a=>{s(a,t)},n},{}),[e,t])}function Rn(e){return c.useMemo(()=>e?Lr(e):null,[e])}const sn=[];function fo(e,t){t===void 0&&(t=Ae);const[n]=e,r=Rn(n?q(n):null),[o,s]=c.useState(sn);function a(){s(()=>e.length?e.map(l=>yn(l)?r:new Dt(t(l),l)):sn)}const i=ct({callback:a});return se(()=>{i==null||i.disconnect(),a(),e.forEach(l=>i==null?void 0:i.observe(l))},[e]),o}function Nn(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Xe(t)?t:e}function ho(e){let{measure:t}=e;const[n,r]=c.useState(null),o=c.useCallback(u=>{for(const{target:h}of u)if(Xe(h)){r(f=>{const p=t(h);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),s=ct({callback:o}),a=c.useCallback(u=>{const h=Nn(u);s==null||s.disconnect(),h&&(s==null||s.observe(h)),r(h?t(h):null)},[t,s]),[i,l]=Ze(a);return c.useMemo(()=>({nodeRef:i,rect:n,setRef:l}),[n,i,l])}const go=[{sensor:Et,options:{}},{sensor:Rt,options:{}}],po={current:{}},Qe={draggable:{measure:Jt},droppable:{measure:Jt,strategy:Ke.WhileDragging,frequency:wt.Optimized},dragOverlay:{measure:Ae}};class Be extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const vo={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Be,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:nt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Qe,measureDroppableContainers:nt,windowRect:null,measuringScheduled:!1},En={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:nt,draggableNodes:new Map,over:null,measureDroppableContainers:nt},He=c.createContext(En),jn=c.createContext(vo);function bo(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Be}}}function mo(e,t){switch(t.type){case F.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case F.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case F.DragEnd:case F.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case F.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new Be(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case F.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const a=new Be(e.droppable.containers);return a.set(n,{...s,disabled:o}),{...e,droppable:{...e.droppable,containers:a}}}case F.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const s=new Be(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function xo(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=c.useContext(He),s=et(r),a=et(n==null?void 0:n.id);return c.useEffect(()=>{if(!t&&!r&&s&&a!=null){if(!at(s)||document.activeElement===s.target)return;const i=o.get(a);if(!i)return;const{activatorNode:l,node:u}=i;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const h of[l.current,u.current]){if(!h)continue;const f=hr(h);if(f){f.focus();break}}})}},[r,t,o,a,s]),null}function In(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,s)=>s({transform:o,...r}),n):n}function yo(e){return c.useMemo(()=>({draggable:{...Qe.draggable,...e==null?void 0:e.draggable},droppable:{...Qe.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Qe.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function wo(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const s=c.useRef(!1),{x:a,y:i}=typeof o=="boolean"?{x:o,y:o}:o;se(()=>{if(!a&&!i||!t){s.current=!1;return}if(s.current||!r)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const h=n(u),f=pn(h,r);if(a||(f.x=0),i||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=bn(u);p&&p.scrollBy({top:f.y,left:f.x})}},[t,a,i,r,n])}const dt=c.createContext({...ie,scaleX:1,scaleY:1});var me;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(me||(me={}));const So=c.memo(function(t){var n,r,o,s;let{id:a,accessibility:i,autoScroll:l=!0,children:u,sensors:h=go,collisionDetection:f=Ir,measuring:p,modifiers:g,...m}=t;const v=c.useReducer(mo,void 0,bo),[b,y]=v,[w,x]=xr(),[D,R]=c.useState(me.Uninitialized),j=D===me.Initialized,{draggable:{active:S,nodes:C,translate:O},droppable:{containers:P}}=b,M=S!=null?C.get(S):null,H=c.useRef({initial:null,translated:null}),J=c.useMemo(()=>{var V;return S!=null?{id:S,data:(V=M==null?void 0:M.data)!=null?V:po,rect:H}:null},[S,M]),te=c.useRef(null),[ye,we]=c.useState(null),[G,A]=c.useState(null),I=$e(m,Object.values(m)),_=Ye("DndDescribedBy",a),ne=c.useMemo(()=>P.getEnabled(),[P]),k=yo(p),{droppableRects:$,measureDroppableContainers:T,measuringScheduled:W}=no(ne,{dragging:j,dependencies:[O.x,O.y],config:k.droppable}),B=eo(C,S),L=c.useMemo(()=>G?tt(G):null,[G]),U=Un(),K=ro(B,k.draggable.measure);wo({activeNode:S!=null?C.get(S):null,config:U.layoutShiftCompensation,initialRect:K,measure:k.draggable.measure});const N=nn(B,k.draggable.measure,K),fe=nn(B?B.parentElement:null),ae=c.useRef({activatorEvent:null,active:null,activeNode:B,collisionRect:null,collisions:null,droppableRects:$,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:P,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Se=P.getNodeFor((n=ae.current.over)==null?void 0:n.id),de=ho({measure:k.dragOverlay.measure}),Ce=(r=de.nodeRef.current)!=null?r:B,De=j?(o=de.rect)!=null?o:N:null,Ot=!!(de.nodeRef.current&&de.rect),kt=io(Ot?null:N),ut=Rn(Ce?q(Ce):null),he=ao(j?Se??B:null),We=fo(he),Ve=In(g,{transform:{x:O.x-kt.x,y:O.y-kt.y,scaleX:1,scaleY:1},activatorEvent:G,active:J,activeNodeRect:N,containerNodeRect:fe,draggingNodeRect:De,over:ae.current.over,overlayNodeRect:de.rect,scrollableAncestors:he,scrollableAncestorRects:We,windowRect:ut}),Tt=L?je(L,O):null,Lt=lo(he),Pn=on(Lt),_n=on(Lt,[N]),Re=je(Ve,Pn),Ne=De?Or(De,Ve):null,Oe=J&&Ne?f({active:J,collisionRect:Ne,droppableRects:$,droppableContainers:ne,pointerCoordinates:Tt}):null,zt=gn(Oe,"id"),[ge,Pt]=c.useState(null),Bn=Ot?Ve:je(Ve,_n),$n=Mr(Bn,(s=ge==null?void 0:ge.rect)!=null?s:null,N),ft=c.useRef(null),_t=c.useCallback((V,Q)=>{let{sensor:Z,options:pe}=Q;if(te.current==null)return;const re=C.get(te.current);if(!re)return;const ee=V.nativeEvent,le=new Z({active:te.current,activeNode:re,event:ee,options:pe,context:ae,onAbort(Y){if(!C.get(Y))return;const{onDragAbort:ce}=I.current,ue={id:Y};ce==null||ce(ue),w({type:"onDragAbort",event:ue})},onPending(Y,ve,ce,ue){if(!C.get(Y))return;const{onDragPending:Te}=I.current,be={id:Y,constraint:ve,initialCoordinates:ce,offset:ue};Te==null||Te(be),w({type:"onDragPending",event:be})},onStart(Y){const ve=te.current;if(ve==null)return;const ce=C.get(ve);if(!ce)return;const{onDragStart:ue}=I.current,ke={activatorEvent:ee,active:{id:ve,data:ce.data,rect:H}};ze.unstable_batchedUpdates(()=>{ue==null||ue(ke),R(me.Initializing),y({type:F.DragStart,initialCoordinates:Y,active:ve}),w({type:"onDragStart",event:ke}),we(ft.current),A(ee)})},onMove(Y){y({type:F.DragMove,coordinates:Y})},onEnd:Ee(F.DragEnd),onCancel:Ee(F.DragCancel)});ft.current=le;function Ee(Y){return async function(){const{active:ce,collisions:ue,over:ke,scrollAdjustedTranslate:Te}=ae.current;let be=null;if(ce&&Te){const{cancelDrop:Le}=I.current;be={activatorEvent:ee,active:ce,collisions:ue,delta:Te,over:ke},Y===F.DragEnd&&typeof Le=="function"&&await Promise.resolve(Le(be))&&(Y=F.DragCancel)}te.current=null,ze.unstable_batchedUpdates(()=>{y({type:Y}),R(me.Uninitialized),Pt(null),we(null),A(null),ft.current=null;const Le=Y===F.DragEnd?"onDragEnd":"onDragCancel";if(be){const ht=I.current[Le];ht==null||ht(be),w({type:Le,event:be})}})}}},[C]),Fn=c.useCallback((V,Q)=>(Z,pe)=>{const re=Z.nativeEvent,ee=C.get(pe);if(te.current!==null||!ee||re.dndKit||re.defaultPrevented)return;const le={active:ee};V(Z,Q.options,le)===!0&&(re.dndKit={capturedBy:Q.sensor},te.current=pe,_t(Z,Q))},[C,_t]),Bt=to(h,Fn);co(h),se(()=>{N&&D===me.Initializing&&R(me.Initialized)},[N,D]),c.useEffect(()=>{const{onDragMove:V}=I.current,{active:Q,activatorEvent:Z,collisions:pe,over:re}=ae.current;if(!Q||!Z)return;const ee={active:Q,activatorEvent:Z,collisions:pe,delta:{x:Re.x,y:Re.y},over:re};ze.unstable_batchedUpdates(()=>{V==null||V(ee),w({type:"onDragMove",event:ee})})},[Re.x,Re.y]),c.useEffect(()=>{const{active:V,activatorEvent:Q,collisions:Z,droppableContainers:pe,scrollAdjustedTranslate:re}=ae.current;if(!V||te.current==null||!Q||!re)return;const{onDragOver:ee}=I.current,le=pe.get(zt),Ee=le&&le.rect.current?{id:le.id,rect:le.rect.current,data:le.data,disabled:le.disabled}:null,Y={active:V,activatorEvent:Q,collisions:Z,delta:{x:re.x,y:re.y},over:Ee};ze.unstable_batchedUpdates(()=>{Pt(Ee),ee==null||ee(Y),w({type:"onDragOver",event:Y})})},[zt]),se(()=>{ae.current={activatorEvent:G,active:J,activeNode:B,collisionRect:Ne,collisions:Oe,droppableRects:$,draggableNodes:C,draggingNode:Ce,draggingNodeRect:De,droppableContainers:P,over:ge,scrollableAncestors:he,scrollAdjustedTranslate:Re},H.current={initial:De,translated:Ne}},[J,B,Oe,Ne,C,Ce,De,$,P,ge,he,Re]),Jr({...U,delta:O,draggingRect:Ne,pointerCoordinates:Tt,scrollableAncestors:he,scrollableAncestorRects:We});const Kn=c.useMemo(()=>({active:J,activeNode:B,activeNodeRect:N,activatorEvent:G,collisions:Oe,containerNodeRect:fe,dragOverlay:de,draggableNodes:C,droppableContainers:P,droppableRects:$,over:ge,measureDroppableContainers:T,scrollableAncestors:he,scrollableAncestorRects:We,measuringConfiguration:k,measuringScheduled:W,windowRect:ut}),[J,B,N,G,Oe,fe,de,C,P,$,ge,T,he,We,k,W,ut]),Xn=c.useMemo(()=>({activatorEvent:G,activators:Bt,active:J,activeNodeRect:N,ariaDescribedById:{draggable:_},dispatch:y,draggableNodes:C,over:ge,measureDroppableContainers:T}),[G,Bt,J,N,y,_,C,ge,T]);return z.createElement(un.Provider,{value:x},z.createElement(He.Provider,{value:Xn},z.createElement(jn.Provider,{value:Kn},z.createElement(dt.Provider,{value:$n},u)),z.createElement(xo,{disabled:(i==null?void 0:i.restoreFocus)===!1})),z.createElement(Sr,{...i,hiddenTextDescribedById:_}));function Un(){const V=(ye==null?void 0:ye.autoScrollEnabled)===!1,Q=typeof l=="object"?l.enabled===!1:l===!1,Z=j&&!V&&!Q;return typeof l=="object"?{...l,enabled:Z}:{enabled:Z}}}),Co=c.createContext(null),an="button",Do="Draggable";function Mn(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const s=Ye(Do),{activators:a,activatorEvent:i,active:l,activeNodeRect:u,ariaDescribedById:h,draggableNodes:f,over:p}=c.useContext(He),{role:g=an,roleDescription:m="draggable",tabIndex:v=0}=o??{},b=(l==null?void 0:l.id)===t,y=c.useContext(b?dt:Co),[w,x]=Ze(),[D,R]=Ze(),j=uo(a,t),S=$e(n);se(()=>(f.set(t,{id:t,key:s,node:w,activatorNode:D,data:S}),()=>{const O=f.get(t);O&&O.key===s&&f.delete(t)}),[f,t]);const C=c.useMemo(()=>({role:g,tabIndex:v,"aria-disabled":r,"aria-pressed":b&&g===an?!0:void 0,"aria-roledescription":m,"aria-describedby":h.draggable}),[r,g,v,b,m,h.draggable]);return{active:l,activatorEvent:i,activeNodeRect:u,attributes:C,isDragging:b,listeners:r?void 0:j,node:w,over:p,setNodeRef:x,setActivatorNodeRef:R,transform:y}}function It(){return c.useContext(jn)}const Ro="Droppable",No={timeout:25};function Eo(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const s=Ye(Ro),{active:a,dispatch:i,over:l,measureDroppableContainers:u}=c.useContext(He),h=c.useRef({disabled:n}),f=c.useRef(!1),p=c.useRef(null),g=c.useRef(null),{disabled:m,updateMeasurementsFor:v,timeout:b}={...No,...o},y=$e(v??r),w=c.useCallback(()=>{if(!f.current){f.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{u(Array.isArray(y.current)?y.current:[y.current]),g.current=null},b)},[b]),x=ct({callback:w,disabled:m||!a}),D=c.useCallback((C,O)=>{x&&(O&&(x.unobserve(O),f.current=!1),C&&x.observe(C))},[x]),[R,j]=Ze(D),S=$e(t);return c.useEffect(()=>{!x||!R.current||(x.disconnect(),f.current=!1,x.observe(R.current))},[R,x]),c.useEffect(()=>(i({type:F.RegisterDroppable,element:{id:r,key:s,disabled:n,node:R,rect:p,data:S}}),()=>i({type:F.UnregisterDroppable,key:s,id:r})),[r]),c.useEffect(()=>{n!==h.current.disabled&&(i({type:F.SetDroppableDisabled,id:r,key:s,disabled:n}),h.current.disabled=n)},[r,s,n,i]),{active:a,rect:p,isOver:(l==null?void 0:l.id)===r,node:R,over:l,setNodeRef:j}}function jo(e){let{animation:t,children:n}=e;const[r,o]=c.useState(null),[s,a]=c.useState(null),i=et(n);return!n&&!r&&i&&o(i),se(()=>{if(!s)return;const l=r==null?void 0:r.key,u=r==null?void 0:r.props.id;if(l==null||u==null){o(null);return}Promise.resolve(t(u,s)).then(()=>{o(null)})},[t,r,s]),z.createElement(z.Fragment,null,n,r?c.cloneElement(r,{ref:a}):null)}const Io={x:0,y:0,scaleX:1,scaleY:1};function Mo(e){let{children:t}=e;return z.createElement(He.Provider,{value:En},z.createElement(dt.Provider,{value:Io},t))}const Ao={position:"fixed",touchAction:"none"},Oo=e=>at(e)?"transform 250ms ease":void 0,ko=c.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:o,children:s,className:a,rect:i,style:l,transform:u,transition:h=Oo}=e;if(!i)return null;const f=o?u:{...u,scaleX:1,scaleY:1},p={...Ao,width:i.width,height:i.height,top:i.top,left:i.left,transform:xe.Transform.toString(f),transformOrigin:o&&r?Dr(r,i):void 0,transition:typeof h=="function"?h(r):h,...l};return z.createElement(n,{className:a,style:p,ref:t},s)}),Mt=e=>t=>{let{active:n,dragOverlay:r}=t;const o={},{styles:s,className:a}=e;if(s!=null&&s.active)for(const[i,l]of Object.entries(s.active))l!==void 0&&(o[i]=n.node.style.getPropertyValue(i),n.node.style.setProperty(i,l));if(s!=null&&s.dragOverlay)for(const[i,l]of Object.entries(s.dragOverlay))l!==void 0&&r.node.style.setProperty(i,l);return a!=null&&a.active&&n.node.classList.add(a.active),a!=null&&a.dragOverlay&&r.node.classList.add(a.dragOverlay),function(){for(const[l,u]of Object.entries(o))n.node.style.setProperty(l,u);a!=null&&a.active&&n.node.classList.remove(a.active)}},To=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:xe.Transform.toString(t)},{transform:xe.Transform.toString(n)}]},Lo={duration:250,easing:"ease",keyframes:To,sideEffects:Mt({styles:{active:{opacity:"0"}}})};function zo(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:o}=e;return it((s,a)=>{if(t===null)return;const i=n.get(s);if(!i)return;const l=i.node.current;if(!l)return;const u=Nn(a);if(!u)return;const{transform:h}=q(a).getComputedStyle(a),f=vn(h);if(!f)return;const p=typeof t=="function"?t:Po(t);return Cn(l,o.draggable.measure),p({active:{id:s,data:i.data,node:l,rect:o.draggable.measure(l)},draggableNodes:n,dragOverlay:{node:a,rect:o.dragOverlay.measure(u)},droppableContainers:r,measuringConfiguration:o,transform:f})})}function Po(e){const{duration:t,easing:n,sideEffects:r,keyframes:o}={...Lo,...e};return s=>{let{active:a,dragOverlay:i,transform:l,...u}=s;if(!t)return;const h={x:i.rect.left-a.rect.left,y:i.rect.top-a.rect.top},f={scaleX:l.scaleX!==1?a.rect.width*l.scaleX/i.rect.width:1,scaleY:l.scaleY!==1?a.rect.height*l.scaleY/i.rect.height:1},p={x:l.x-h.x,y:l.y-h.y,...f},g=o({...u,active:a,dragOverlay:i,transform:{initial:l,final:p}}),[m]=g,v=g[g.length-1];if(JSON.stringify(m)===JSON.stringify(v))return;const b=r==null?void 0:r({active:a,dragOverlay:i,...u}),y=i.node.animate(g,{duration:t,easing:n,fill:"forwards"});return new Promise(w=>{y.onfinish=()=>{b==null||b(),w()}})}}let ln=0;function _o(e){return c.useMemo(()=>{if(e!=null)return ln++,ln},[e])}const An=z.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:o,transition:s,modifiers:a,wrapperElement:i="div",className:l,zIndex:u=999}=e;const{activatorEvent:h,active:f,activeNodeRect:p,containerNodeRect:g,draggableNodes:m,droppableContainers:v,dragOverlay:b,over:y,measuringConfiguration:w,scrollableAncestors:x,scrollableAncestorRects:D,windowRect:R}=It(),j=c.useContext(dt),S=_o(f==null?void 0:f.id),C=In(a,{activatorEvent:h,active:f,activeNodeRect:p,containerNodeRect:g,draggingNodeRect:b.rect,over:y,overlayNodeRect:b.rect,scrollableAncestors:x,scrollableAncestorRects:D,transform:j,windowRect:R}),O=jt(p),P=zo({config:r,draggableNodes:m,droppableContainers:v,measuringConfiguration:w}),M=O?b.setRef:void 0;return z.createElement(Mo,null,z.createElement(jo,{animation:P},f&&S?z.createElement(ko,{key:S,id:f.id,ref:M,as:i,activatorEvent:h,adjustScale:t,className:l,transition:s,rect:O,style:{zIndex:u,...o},transform:C},n):null))});function At(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Bo(e,t){return e.reduce((n,r,o)=>{const s=t.get(r);return s&&(n[o]=s),n},Array(e.length))}function qe(e){return e!==null&&e>=0}function $o(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Fo(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const On=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const s=At(t,r,n),a=t[o],i=s[o];return!i||!a?null:{x:i.left-a.left,y:i.top-a.top,scaleX:i.width/a.width,scaleY:i.height/a.height}},Je={scaleX:1,scaleY:1},Ko=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:s,overIndex:a}=e;const i=(t=s[n])!=null?t:r;if(!i)return null;if(o===n){const u=s[a];return u?{x:0,y:n<a?u.top+u.height-(i.top+i.height):u.top-i.top,...Je}:null}const l=Xo(s,o,n);return o>n&&o<=a?{x:0,y:-i.height-l,...Je}:o<n&&o>=a?{x:0,y:i.height+l,...Je}:{x:0,y:0,...Je}};function Xo(e,t,n){const r=e[t],o=e[t-1],s=e[t+1];return r?n<t?o?r.top-(o.top+o.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}const kn="Sortable",Tn=z.createContext({activeIndex:-1,containerId:kn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:On,disabled:{draggable:!1,droppable:!1}});function Uo(e){let{children:t,id:n,items:r,strategy:o=On,disabled:s=!1}=e;const{active:a,dragOverlay:i,droppableRects:l,over:u,measureDroppableContainers:h}=It(),f=Ye(kn,n),p=i.rect!==null,g=c.useMemo(()=>r.map(j=>typeof j=="object"&&"id"in j?j.id:j),[r]),m=a!=null,v=a?g.indexOf(a.id):-1,b=u?g.indexOf(u.id):-1,y=c.useRef(g),w=!$o(g,y.current),x=b!==-1&&v===-1||w,D=Fo(s);se(()=>{w&&m&&h(g)},[w,g,m,h]),c.useEffect(()=>{y.current=g},[g]);const R=c.useMemo(()=>({activeIndex:v,containerId:f,disabled:D,disableTransforms:x,items:g,overIndex:b,useDragOverlay:p,sortedRects:Bo(g,l),strategy:o}),[v,f,D.draggable,D.droppable,x,g,b,l,p,o]);return z.createElement(Tn.Provider,{value:R},t)}const Yo=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return At(n,r,o).indexOf(t)},Ho=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:s,newIndex:a,previousItems:i,previousContainerId:l,transition:u}=e;return!u||!r||i!==s&&o===a?!1:n?!0:a!==o&&t===l},Wo={duration:200,easing:"ease"},Ln="transform",Vo=xe.Transition.toString({property:Ln,duration:0,easing:"linear"}),Go={roleDescription:"sortable"};function qo(e){let{disabled:t,index:n,node:r,rect:o}=e;const[s,a]=c.useState(null),i=c.useRef(n);return se(()=>{if(!t&&n!==i.current&&r.current){const l=o.current;if(l){const u=Ae(r.current,{ignoreTransform:!0}),h={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(h.x||h.y)&&a(h)}}n!==i.current&&(i.current=n)},[t,n,r,o]),c.useEffect(()=>{s&&a(null)},[s]),s}function Jo(e){let{animateLayoutChanges:t=Ho,attributes:n,disabled:r,data:o,getNewIndex:s=Yo,id:a,strategy:i,resizeObserverConfig:l,transition:u=Wo}=e;const{items:h,containerId:f,activeIndex:p,disabled:g,disableTransforms:m,sortedRects:v,overIndex:b,useDragOverlay:y,strategy:w}=c.useContext(Tn),x=Qo(r,g),D=h.indexOf(a),R=c.useMemo(()=>({sortable:{containerId:f,index:D,items:h},...o}),[f,o,D,h]),j=c.useMemo(()=>h.slice(h.indexOf(a)),[h,a]),{rect:S,node:C,isOver:O,setNodeRef:P}=Eo({id:a,data:R,disabled:x.droppable,resizeObserverConfig:{updateMeasurementsFor:j,...l}}),{active:M,activatorEvent:H,activeNodeRect:J,attributes:te,setNodeRef:ye,listeners:we,isDragging:G,over:A,setActivatorNodeRef:I,transform:_}=Mn({id:a,data:R,attributes:{...Go,...n},disabled:x.draggable}),ne=cr(P,ye),k=!!M,$=k&&!m&&qe(p)&&qe(b),T=!y&&G,W=T&&$?_:null,L=$?W??(i??w)({rects:v,activeNodeRect:J,activeIndex:p,overIndex:b,index:D}):null,U=qe(p)&&qe(b)?s({id:a,items:h,activeIndex:p,overIndex:b}):D,K=M==null?void 0:M.id,N=c.useRef({activeId:K,items:h,newIndex:U,containerId:f}),fe=h!==N.current.items,ae=t({active:M,containerId:f,isDragging:G,isSorting:k,id:a,index:D,items:h,newIndex:N.current.newIndex,previousItems:N.current.items,previousContainerId:N.current.containerId,transition:u,wasDragging:N.current.activeId!=null}),Se=qo({disabled:!ae,index:D,node:C,rect:S});return c.useEffect(()=>{k&&N.current.newIndex!==U&&(N.current.newIndex=U),f!==N.current.containerId&&(N.current.containerId=f),h!==N.current.items&&(N.current.items=h)},[k,U,f,h]),c.useEffect(()=>{if(K===N.current.activeId)return;if(K!=null&&N.current.activeId==null){N.current.activeId=K;return}const Ce=setTimeout(()=>{N.current.activeId=K},50);return()=>clearTimeout(Ce)},[K]),{active:M,activeIndex:p,attributes:te,data:R,rect:S,index:D,newIndex:U,items:h,isOver:O,isSorting:k,isDragging:G,listeners:we,node:C,overIndex:b,over:A,setNodeRef:ne,setActivatorNodeRef:I,setDroppableNodeRef:P,setDraggableNodeRef:ye,transform:Se??L,transition:de()};function de(){if(Se||fe&&N.current.newIndex===D)return Vo;if(!(T&&!at(H)||!u)&&(k||ae))return xe.Transition.toString({...u,property:Ln})}}function Qo(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function ot(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Zo=[E.Down,E.Right,E.Up,E.Left],es=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:o,droppableContainers:s,over:a,scrollableAncestors:i}}=t;if(Zo.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];s.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=o.get(f.id);if(p)switch(e.code){case E.Down:r.top<p.top&&l.push(f);break;case E.Up:r.top>p.top&&l.push(f);break;case E.Left:r.left>p.left&&l.push(f);break;case E.Right:r.left<p.left&&l.push(f);break}});const u=Er({collisionRect:r,droppableRects:o,droppableContainers:l});let h=gn(u,"id");if(h===(a==null?void 0:a.id)&&u.length>1&&(h=u[1].id),h!=null){const f=s.get(n.id),p=s.get(h),g=p?o.get(p.id):null,m=p==null?void 0:p.node.current;if(m&&g&&f&&p){const b=lt(m).some((j,S)=>i[S]!==j),y=zn(f,p),w=ts(f,p),x=b||!y?{x:0,y:0}:{x:w?r.width-g.width:0,y:w?r.height-g.height:0},D={x:g.left,y:g.top};return x.x&&x.y?D:Fe(D,x)}}}};function zn(e,t){return!ot(e)||!ot(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function ts(e,t){return!ot(e)||!ot(t)||!zn(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const ns=({id:e,children:t,isSelected:n,onSelect:r,onDelete:o,onDuplicate:s,onToggleVisibility:a,isVisible:i=!0})=>{const{attributes:l,listeners:u,setNodeRef:h,transform:f,transition:p,isDragging:g}=Jo({id:e}),m={transform:xe.Transform.toString(f),transition:p,opacity:g?.4:1,zIndex:g?999:"auto",position:"relative"};return d.jsxs("div",{ref:h,style:m,className:`group relative transition-all duration-200 ${n?"ring-2 ring-accent-primary ring-offset-2 rounded-xl z-10":"hover:ring-1 hover:ring-border rounded-xl"} ${i?"":"opacity-50 grayscale"}`,onClick:v=>{v.stopPropagation(),r==null||r()},children:[d.jsx("div",{...l,...u,className:`absolute -left-8 top-1/2 -translate-y-1/2 p-2 cursor-grab active:cursor-grabbing text-textMuted hover:text-textMain transition-opacity ${n||g?"opacity-100":"opacity-0 group-hover:opacity-100"}`,children:d.jsx(Yn,{size:20})}),n&&d.jsxs("div",{className:"absolute -top-10 right-0 flex items-center gap-1 bg-gray-900 text-white p-1 rounded-lg shadow-xl animate-scale-in origin-bottom z-50",children:[d.jsx("button",{onClick:v=>{v.stopPropagation(),a==null||a()},className:"p-1.5 hover:bg-white/20 rounded transition-colors",title:i?"Hide":"Show",children:d.jsx(Hn,{size:14})}),d.jsx("button",{onClick:v=>{v.stopPropagation(),s==null||s()},className:"p-1.5 hover:bg-white/20 rounded transition-colors",title:"Duplicate",children:d.jsx(Wn,{size:14})}),d.jsx("div",{className:"w-px h-4 bg-white/20 mx-1"}),d.jsx("button",{onClick:v=>{v.stopPropagation(),o==null||o()},className:"p-1.5 hover:bg-red-500 rounded transition-colors text-red-300 hover:text-white",title:"Remove",children:d.jsx(Vn,{size:14})})]}),d.jsx("div",{className:i?"":"pointer-events-none select-none",children:t}),!i&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:d.jsx("span",{className:"bg-gray-900 text-white text-xs px-2 py-1 rounded font-bold uppercase tracking-wider opacity-80",children:"Hidden"})})]})},rs=({layoutConfig:e,listing:t,selectedSectionId:n,onSelectSection:r,onToggleVisibility:o,onDeleteSection:s,previewDevice:a})=>{var p,g;const{active:i}=It(),l={...t,layout_config:e},u=e.sections.filter(m=>m.area==="main"),h=e.sections.filter(m=>m.area==="sidebar"),f=(m,v)=>d.jsxs(Uo,{items:m.map(b=>b.id),strategy:Ko,children:[d.jsx("div",{className:"text-xs font-bold uppercase text-gray-300 mb-2 tracking-widest text-center border-b border-gray-100 pb-2",children:v}),d.jsxs("div",{className:"space-y-6 min-h-[100px] p-2 rounded-xl border-2 border-transparent hover:border-dashed hover:border-gray-200 transition-colors",children:[m.map(b=>d.jsx(ns,{id:b.id,isSelected:n===b.id,isVisible:b.visible,onSelect:()=>r(b.id),onToggleVisibility:()=>o(b.id),onDelete:()=>s(b.id),children:d.jsx("div",{className:`pointer-events-none ${b.visible?"":"opacity-50 grayscale"}`,children:d.jsx(os,{section:b,listing:l})})},b.id)),m.length===0&&d.jsx("div",{className:"h-20 flex items-center justify-center text-gray-300 text-sm italic border-2 border-dashed border-gray-100 rounded-lg",children:"Drop items here"})]})]});return d.jsxs("div",{className:`mx-auto bg-white shadow-2xl transition-all duration-300 origin-top overflow-hidden relative ${a==="mobile"?"w-[375px] min-h-[812px] rounded-3xl border-8 border-gray-800 my-8":"w-full max-w-[1240px] min-h-screen pt-12 pb-20 px-8"}`,onClick:m=>{m.stopPropagation(),r(null)},children:[d.jsxs("div",{className:"mb-8 pointer-events-none opacity-50",children:[d.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded mb-4"}),d.jsx("div",{className:"h-8 w-64 bg-gray-100 rounded"})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start relative",children:[d.jsx("div",{className:"lg:col-span-8",children:f(u,"Main Content Zone")}),d.jsx("div",{className:"lg:col-span-4",children:f(h,"Sticky Sidebar Zone")})]}),d.jsx(An,{dropAnimation:{sideEffects:Mt({styles:{active:{opacity:"0.5"}}})},children:(g=(p=i==null?void 0:i.data)==null?void 0:p.current)!=null&&g.type&&!i.data.current.isSource?d.jsx("div",{className:"bg-white p-4 rounded-xl shadow-2xl ring-2 ring-accent-primary opacity-90 rotate-2 cursor-grabbing scale-95",children:d.jsx("div",{className:"h-10 w-full bg-gray-100 rounded animate-pulse"})}):null})]})},os=({section:e,listing:t})=>{const n=e.type||e.id,r=ar[n];return r?d.jsx(r,{listing:t,section:e}):d.jsxs("div",{className:"p-4 border border-dashed border-red-300 text-red-500 rounded text-xs",children:["Unknown: ",e.id]})},ss=[{id:"hero",label:"Hero Section",description:"Title, category, and key tags"},{id:"media",label:"Media Gallery",description:"Images and video carousel"},{id:"description",label:"Description",description:"Executive summary & details"},{id:"features",label:"Features & Files",description:"Deliverables checklist"},{id:"tech_stack",label:"Tech Stack",description:"Technologies used"},{id:"target_audience",label:"Target Audience",description:"Who is this for?"},{id:"pricing",label:"Pricing Card",description:"Purchase options"},{id:"trust_badge",label:"Trust Badge",description:"Guarantee info"},{id:"stats",label:"Stats",description:"Performance metrics"},{id:"seller_card",label:"Seller Profile",description:"Creator bio and stats"}],is=({isOpen:e,onClose:t,layoutConfig:n,onAddSection:r})=>{const o=n.sections.filter(s=>!s.visible);return e?d.jsxs("div",{className:"absolute top-0 left-16 bottom-0 w-80 bg-white border-r border-border shadow-xl z-30 flex flex-col animate-slide-in-left",children:[d.jsxs("div",{className:"p-4 border-b border-border flex justify-between items-center bg-gray-50",children:[d.jsx("h3",{className:"font-bold text-sm uppercase tracking-wider text-textMain",children:"Add Section"}),d.jsx("button",{onClick:t,className:"text-textMuted hover:text-textMain text-xl",children:""})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[o.length===0?d.jsx("div",{className:"text-center py-10 text-textMuted text-sm",children:"All sections are currently visible on the canvas."}):o.map(s=>{const a=ss.find(i=>i.id===s.id);return d.jsxs("div",{className:"p-3 border border-dashed border-gray-300 rounded-lg hover:border-accent-primary hover:bg-accent-primary/5 transition-all group flex items-start gap-3",children:[d.jsx("div",{className:"mt-1 text-textMuted group-hover:text-accent-primary",children:d.jsx(Gn,{size:16})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h4",{className:"font-bold text-sm text-textMain",children:(a==null?void 0:a.label)||s.id}),d.jsx("p",{className:"text-xs text-textMuted mt-1",children:a==null?void 0:a.description})]}),d.jsx("button",{onClick:()=>r(s.id),className:"bg-accent-primary text-white text-xs px-2 py-1 rounded shadow-sm opacity-0 group-hover:opacity-100 transition-opacity",children:"Add"})]},s.id)}),d.jsxs("div",{className:"mt-8 pt-6 border-t border-border",children:[d.jsx("h4",{className:"font-bold text-xs uppercase text-textMuted mb-4",children:"Pro Tip"}),d.jsx("p",{className:"text-xs text-textSecondary leading-relaxed",children:"Drag sections directly on the canvas to reorder them. Click a section to edit its visibility and settings."})]})]})]}):null},as=({id:e,type:t,dataKey:n,label:r,value:o,icon:s})=>{const{attributes:a,listeners:i,setNodeRef:l,isDragging:u}=Mn({id:e,data:{isSource:!0,type:t,dataKey:n,label:r}});return o?d.jsxs("div",{ref:l,...i,...a,className:`p-3 bg-white border border-gray-200 rounded-lg shadow-sm hover:border-accent-primary hover:shadow-md cursor-grab active:cursor-grabbing transition-all flex items-center gap-3 ${u?"opacity-50":""}`,children:[d.jsx("div",{className:"text-gray-400",children:s}),d.jsxs("div",{className:"flex-1 overflow-hidden",children:[d.jsx("p",{className:"text-xs font-bold text-gray-700 truncate",children:r}),d.jsxs("p",{className:"text-[10px] text-gray-500 truncate",children:[o.substring(0,30),"..."]})]})]}):null},ls=({listing:e})=>{var s;const t=(a,i)=>d.jsxs("div",{className:"mb-6",children:[d.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:a}),d.jsx("div",{className:"space-y-2",children:i.map(l=>d.jsx(as,{...l},l.id))})]}),n=[{id:"src_title",type:"text_block",dataKey:"title",label:"Listing Title",value:e.title,icon:d.jsx($t,{size:16})},{id:"src_tagline",type:"text_block",dataKey:"tagline",label:"Tagline",value:e.tagline,icon:d.jsx($t,{size:16})},{id:"src_summary",type:"text_block",dataKey:"short_summary",label:"Short Summary",value:e.short_summary,icon:d.jsx(Ft,{size:16})},{id:"src_desc",type:"text_block",dataKey:"description",label:"Full Description",value:e.description,icon:d.jsx(Ft,{size:16})}],r=[{id:"src_thumb",type:"media_block",dataKey:"image",label:"Cover Image",value:e.image,icon:d.jsx(Kt,{size:16})}];(s=e.screenshot_urls)==null||s.forEach((a,i)=>{r.push({id:`src_screen_${i}`,type:"media_block",dataKey:`screenshot_urls.${i}`,label:`Gallery Image ${i+1}`,value:a,icon:d.jsx(Kt,{size:16})})}),e.video_url&&r.push({id:"src_video",type:"video_block",dataKey:"video_url",label:"Demo Video",value:e.video_url,icon:d.jsx(qn,{size:16})});const o=[{id:"src_seller_name",type:"text_block",dataKey:"creator.name",label:"Seller Name",value:e.creator.name,icon:d.jsx(Xt,{size:16})},{id:"src_seller_card",type:"seller_card",dataKey:"creator.id",label:"Seller Profile Card",value:"Full Card",icon:d.jsx(Xt,{size:16})}];return d.jsxs("div",{className:"p-4 overflow-y-auto h-full pb-20",children:[t("Text Content",n),t("Media Assets",r),t("Seller Info",o)]})},cs=()=>Math.random().toString(36).substr(2,9),mt=({icon:e,label:t,active:n=!1,onClick:r})=>d.jsxs("button",{onClick:r,className:`p-3 rounded-xl transition-all group relative ${n?"bg-accent-primary text-white shadow-lg shadow-accent-primary/30":"text-textMuted hover:bg-gray-50 hover:text-textMain"}`,children:[e,d.jsx("span",{className:"absolute left-full ml-3 px-2 py-1 bg-gray-900 text-white text-[10px] rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50 shadow-md",children:t})]}),ms=()=>{const{id:e}=sr(),t=ir(),[n,r]=c.useState(null),[o,s]=c.useState(null),[a,i]=c.useState(!0),[l,u]=c.useState([]),[h,f]=c.useState(-1),[p,g]=c.useState(!1),[m,v]=c.useState("data"),[b,y]=c.useState(!0),[w,x]=c.useState(null),[D,R]=c.useState("desktop"),[j,S]=c.useState(null),[C,O]=c.useState(null),P=Cr(Vt(Et,{activationConstraint:{distance:5}}),Vt(Rt,{coordinateGetter:es})),M=c.useCallback(async A=>{var I,_,ne,k,$,T,W,B;i(!0);try{const{data:L,error:U}=await Ht.from("listings").select(`
                    *,
                    creator:profiles!listings_creator_id_fkey(id, full_name, avatar_url, is_verified_seller, seller_level, rating_average, rating_count, total_sales)
                `).eq("id",A).single();if(U)throw U;const K={...L,creator:{id:(I=L.creator)==null?void 0:I.id,name:((_=L.creator)==null?void 0:_.full_name)||"Creator",avatar:(ne=L.creator)==null?void 0:ne.avatar_url,verified:(k=L.creator)==null?void 0:k.is_verified_seller,rating:(($=L.creator)==null?void 0:$.rating_average)||0,ratingCount:((T=L.creator)==null?void 0:T.rating_count)||0,totalSales:((W=L.creator)==null?void 0:W.total_sales)||0,projectsCompleted:((B=L.creator)==null?void 0:B.total_sales)||0}};r(K);let N=L.layout_config||lr(K);N.sections=N.sections.map(fe=>({...fe,id:String(fe.id)})),s(N),u([N]),f(0)}catch(L){console.error("Error fetching listing:",L),Ge.error("Failed to load listing")}finally{i(!1)}},[]);c.useEffect(()=>{e&&M(e)},[e,M]);const H=c.useCallback(A=>{if(JSON.stringify(A)===JSON.stringify(o))return;const I=l.slice(0,h+1);I.push(A),u(I),f(I.length-1),s(A),g(!0)},[o,l,h]),J=A=>{S(A.active.id),O(A.active.data.current)},te=A=>{var ne;const{active:I,over:_}=A;if(S(null),O(null),!(!o||!_)){if((ne=I.data.current)!=null&&ne.isSource){const k=I.data.current.type,$=I.data.current.dataKey,T={id:cs(),type:k,dataKey:$,visible:!0,order:999,area:"main",settings:{}},W=[...o.sections],B=_.id,L=W.findIndex(K=>K.id===B);L!==-1?(T.area=W[L].area,W.splice(L+1,0,T)):W.push(T);const U=W.map((K,N)=>({...K,order:N}));H({...o,sections:U}),Ge.success("Block added");return}if(I.id!==_.id){const k=o.sections.findIndex(T=>T.id===I.id),$=o.sections.findIndex(T=>T.id===_.id);if(k!==-1&&$!==-1){const T=At(o.sections,k,$),W=o.sections[k],B=o.sections[$];if(W.area!==B.area){T[k]={...T[k],area:B.area};const U=T[$];U.area=B.area}const L=T.map((U,K)=>({...U,order:K}));H({...o,sections:L})}}}},ye=async()=>{if(!n||!o)return;i(!0);const A={...o,sections:o.sections.map(({collapsed:I,highlighted:_,...ne})=>({...ne,highlighted:!1}))};try{const{error:I}=await Ht.from("listings").update({layout_config:A}).eq("id",n.id);if(I)throw I;g(!1),Ge.success("Layout saved")}catch(I){console.error("Save error:",I),Ge.error("Failed to save")}finally{i(!1)}},we=()=>{if(h>0){const A=h-1;f(A),s(l[A]),g(!0)}},G=()=>{if(h<l.length-1){const A=h+1;f(A),s(l[A]),g(!0)}};return a||!n||!o?d.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:"Loading Editor..."}):d.jsx(So,{sensors:P,collisionDetection:Nr,onDragStart:J,onDragEnd:te,children:d.jsxs("div",{className:"flex flex-col h-screen bg-gray-100 overflow-hidden font-sans",children:[d.jsxs("div",{className:"h-16 bg-white border-b border-border flex items-center justify-between px-6 shrink-0 z-50",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("button",{onClick:()=>t("/admin/layout-composer"),className:"p-2 hover:bg-gray-100 rounded-full text-textMuted transition-colors",children:d.jsx(Jn,{size:20})}),d.jsx("div",{className:"h-8 w-px bg-gray-200"}),d.jsxs("div",{children:[d.jsx("h1",{className:"font-bold text-sm text-textMain",children:n.title}),d.jsx("p",{className:"text-[10px] text-textMuted uppercase tracking-wider font-semibold",children:"Visual Editor"})]})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"flex items-center gap-1 bg-gray-100 p-1 rounded-lg mr-4",children:[d.jsx("button",{onClick:we,disabled:h<=0,className:"p-2 rounded hover:bg-white disabled:opacity-30",children:d.jsx(Qn,{size:16})}),d.jsx("button",{onClick:G,disabled:h>=l.length-1,className:"p-2 rounded hover:bg-white disabled:opacity-30",children:d.jsx(Zn,{size:16})})]}),d.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[d.jsx("button",{onClick:()=>R("desktop"),className:`p-2 rounded ${D==="desktop"?"bg-white shadow":"text-gray-400"}`,children:d.jsx(er,{size:18})}),d.jsx("button",{onClick:()=>R("mobile"),className:`p-2 rounded ${D==="mobile"?"bg-white shadow":"text-gray-400"}`,children:d.jsx(tr,{size:18})})]}),d.jsxs("button",{onClick:ye,disabled:!p,className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${p?"bg-accent-primary text-white shadow hover:bg-accent-primary/90":"bg-gray-100 text-textMuted"}`,children:[d.jsx(nr,{size:16}),"Save"]})]})]}),d.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[d.jsxs("div",{className:"w-16 bg-white border-r border-border flex flex-col items-center py-4 gap-4 z-40 relative shadow-lg",children:[d.jsx(mt,{icon:d.jsx(rr,{size:20}),active:b&&m==="data",onClick:()=>{y(!0),v("data")},label:"Content Data"}),d.jsx(mt,{icon:d.jsx(Ut,{size:20}),active:b&&m==="sections",onClick:()=>{y(!0),v("sections")},label:"Saved Blocks"}),d.jsx("div",{className:"mt-auto",children:d.jsx(mt,{icon:d.jsx(or,{size:20}),label:"Settings"})})]}),b&&d.jsxs("div",{className:"w-80 bg-white border-r border-border flex flex-col z-30 animate-slide-in-left shadow-xl relative",children:[d.jsxs("div",{className:"p-4 border-b border-border flex justify-between items-center bg-gray-50",children:[d.jsx("h3",{className:"font-bold text-sm uppercase tracking-wider text-textMain",children:m==="data"?"Submission Content":"Section Blocks"}),d.jsx("button",{onClick:()=>y(!1),className:"text-gray-400 hover:text-black",children:d.jsx(Yt,{size:18})})]}),d.jsx("div",{className:"flex-1 overflow-y-auto",children:m==="data"?d.jsx(ls,{listing:n}):d.jsx(is,{isOpen:!0,onClose:()=>{},layoutConfig:o,onAddSection:A=>{}})})]}),d.jsx("div",{className:"flex-1 overflow-y-auto bg-[#F0F2F5] relative dotted-pattern",onClick:()=>x(null),children:d.jsx(rs,{listing:n,layoutConfig:o,selectedSectionId:w,onSelectSection:x,onToggleVisibility:A=>{const I=o.sections.map(_=>_.id===A?{..._,visible:!_.visible}:_);H({...o,sections:I})},onDeleteSection:A=>{const I=o.sections.filter(_=>_.id!==A);H({...o,sections:I})},previewDevice:D})}),w&&d.jsxs("div",{className:"w-80 bg-white border-l border-border h-full absolute right-0 top-0 bottom-0 shadow-lg animate-slide-in-right z-30 p-4",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4 pb-2 border-b border-gray-100",children:[d.jsx("h3",{className:"font-bold text-sm text-textMain capitalize",children:"Properties"}),d.jsx("button",{onClick:()=>x(null),children:d.jsx(Yt,{size:16})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-textMuted mb-1 block",children:"ID"}),d.jsx("div",{className:"text-xs font-mono bg-gray-50 p-2 rounded truncate",children:w})]}),d.jsx("div",{className:"p-4 bg-blue-50 text-blue-800 text-xs rounded border border-blue-100",children:"Visual settings for this block are available here. Content is managed via the Data Panel."})]})]})]}),d.jsx(An,{dropAnimation:{sideEffects:Mt({styles:{active:{opacity:"0.8"}}})},children:j&&(C!=null&&C.isSource)?d.jsx("div",{className:"p-3 bg-white border border-accent-primary shadow-xl rounded-lg w-64 rotate-3 opacity-90 cursor-grabbing",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded flex items-center justify-center",children:d.jsx(Ut,{size:16,className:"text-accent-primary"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-bold text-gray-800",children:C.label}),d.jsx("p",{className:"text-[10px] text-gray-500",children:"Drop to add to layout"})]})]})}):null})]})})};export{ms as default};
